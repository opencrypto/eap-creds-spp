<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE rfc [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">
]>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" submissionType="IETF" docName="draft-pala-tian-eap-creds-spp-02" category="std" ipr="trust200902" obsoletes="" updates="" xml:lang="en" symRefs="true" sortRefs="true" tocInclude="true" version="3">
  <!-- xml2rfc v2v3 conversion 3.13.0 -->
  <!-- Generated by id2xml 1.5.0 on 2022-06-30T16:54:11Z -->
	<front>
    <title abbrev="EAP-CREDS-SPP">Credentials Provisioning and Management via EAP Method (EAP-CREDS)</title>
    <seriesInfo name="Internet-Draft" value="draft-pala-tian-eap-creds-spp-02"/>
    <author initials="M." surname="Pala" fullname="Massimiliano Pala">
      <organization>CableLabs</organization>
      <address>
        <postal>
          <street>858 Coal Creek Cir</street>
          <street>Louisville, CO  80027</street>
          <street>US</street>
        </postal>
        <email>m.pala@openca.org</email>
        <uri>http://www.linkedin.com/in/mpala</uri>
      </address>
    </author>
    <author initials="Y." surname="Tian" fullname="Yuan Tian">
      <organization>CableLabs</organization>
      <address>
        <postal>
          <street>858 Coal Creek Cir</street>
          <street>Louisville, CO  80027</street>
          <street>US</street>
        </postal>
        <email>yuanalexiatian@gmail.com</email>
        <uri>http://www.linkedin.com/in/ytian21</uri>
      </address>
    </author>
    <date year="2023" month="May" day="1"/>
    <abstract>
      <t>
   With the increase number of devices, protocols, and applications that
   rely on strong credentials (e.g., digital certificates, keys, or
   tokens) for network access, the need for a standardized credentials
   provisioning and management framework is paramount.  The 802.1x
   architecture allows for entities (e.g., devices, applications, etc.)
   to authenticate to the network by providing a communication channel
   where different methods can be used to exchange different types of
   credentials.  EAP-CREDS is an EAP method that specifically designed
   for credential provisioning and management.  If implemented in Access
   Networks (e.g., wired), EAP-CREDS can offer credentials management
   services such as registration, provisioning, and renewal.  Besides,
   EAP-CREDS provides protocol encapsulation mechanism that allows it to
   use with other credential management protocols.  Therefore, this
   document defines how to use EAP-CREDS with the Simple Provisioning
   Protocol (SPP) to support the provisioning and management of
   authentication credentials for user and/or devices in an access
   network.  Other credential provisioning protocols can also use this
   document as a guideline and template for its own encapsulation with
   EAP-CREDS.</t>
    </abstract>
  </front>
  <middle>
    <section anchor="sect-1" numbered="true" toc="default">
      <name>Requirements notation</name>
      <t>
   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <xref target="RFC2119" format="default"/>.</t>
    </section>
    <section anchor="sect-2" numbered="true" toc="default">
      <name>Introduction</name>
      <t>
   Many environments are, today, moving towards requiring strong
   authentication when it comes to gain access to networks.  However,
   the provisioning and management of these credentials is a hard
   problem to solve and many vendors opt for long-lived credentials that
   can not be easily revoked, replaced, or simply renewed.  The 802.1x
   architecture provides network administrators with the possibility to
   check credentials presented by a device even before providing any
   connectivity or IP services to it.  This specification addresses the
   problem of providing a simple-to-use and simple-to-deploy conduit for
   credentials management by extending the EAP protocol to support
   credentials provisioning and management functionality.  In
   particular, the EAP-CREDS method defined in provides a generic
   framework that can carry the messages for provisioning different
   types of credentials.  EAP-CREDS implements the Simple Provisioning
   Protocol (SPP) which comprises of a series of messages that enable
   the management not only of certificates, but also of other types of
   credentials like username/password pairs, asymmetric keys, and
   symmetric keys.  EAP-CREDS cannot be used as a stand-alone method.
   It is required that EAP-CREDS is used as an inner method of EAP-TLS,
   EAP-TEAP, or any other tunnelling method that can provide the
   required secrecy and (at minimum) server-side authentication to make
   sure that the communication is protected and with the right server.</t>
      <section anchor="sect-2.1" numbered="true" toc="default">
        <name>Overview of existing solutions</name>
        <t>
   Currently, there are many protocols that address credentials
   lifecycle management.  Particularly, when it comes to digital
   certificates, some of the most deployed management protocols are:
   Certificate Management Protocol (CMP) <xref target="RFC4210" format="default"/>, Certificate
   Management over CMS (CMC) <xref target="RFC5272" format="default"/><xref target="RFC6402" format="default"/>, Enrollment over Secure
   Transport (EST) <xref target="RFC7030" format="default"/>, and Automated Certificate Management
   Environment (ACME) .  However, none of these protocols provide native
   support for client that do not have IP connectivity yet (e.g.,
   because they do not have network-access credentials, yet).  EAP-CREDS
   provides the possibility to use such protocols (i.e., message-based)
   by defining a series of messages that can be used to encapsulate the
   provisioning messages for the selected provisioning protocol.  In
   addition to these protocols, EAP-CREDS also defines a series of
   simple messages that provide a generic enrollment protocol that
   allows not only certificates but also other types of credentials
   (e.g., username/password pairs, tokens, or symmetric secrets) to be
   delivered to the client as part of the provisioning and/or renewal
   process.  The set of messages that make up the generic provisioning
   protocol is referred to as the Simple Provisioning Protocol protocol
   or SPP.</t>
      </section>
      <section anchor="sect-2.2" numbered="true" toc="default">
        <name>Scope Statement</name>
        <t>
   This document focuses on the definition of the EAP-CREDS method to
   convey credentials provisioning and managing messages between the
   client and the AAA server.  Moreover, the document defines how to
   encode messages for the main IETF provisioning protocols.  This
   document, however, does not provide specifications for how and where
   the credentials are generated.  In particular, the credentials could
   be generated directly within the AAA server or at a different
   location (i.e., the Certificate Service Provider or CSP) site.
   Different authentication mechanisms (e.g., TLS, etc.) can be used to
   secure the communication between the server's endpoint and the CSP.</t>
      </section>
      <section anchor="sect-2.3" numbered="true" toc="default">
        <name>EAP-CREDS as tunneled mechanism only</name>
        <t>
   EAP-CREDS requires that an outer mechanism is in place between the
   Peer and the Server in order to provide authentication and
   confidentiality of the messages exchanged via EAP-CREDS.  In other
   words, EAP-CREDS assumes that an appropriatly encrypted and
   authenticated channel has been established to prevent the possibility
   to leak information or to allow man-in-the-middle attacks.</t>
        <t>
   This choice was taken to simplify the message flow between Peer and
   Server, and to abstract EAP-CREDS from the secure-channel
   establishment mechanism.  EAP-TLS, or EAP-TEAP are examples of such
   mechanisms.s</t>
      </section>
      <section anchor="sect-2.4" numbered="true" toc="default">
        <name>Fragmentation Support</name>
        <t>
   EAP does not directly support handling fragmented packets and it
   requires the outer method to provide fragmentation support.</t>
        <t>
   Because of the outer method requirements in particular, removing any
   support for fragmented messages in EAP-CREDS removes the duplication
   of packets (e.g., Acknowledgment Packets) sent across the Peer and
   the Server, thus resulting in a smaller number of exchanged messages</t>
      </section>
      <section anchor="sect-2.5" numbered="true" toc="default">
        <name>Encapsulating Provisioning Protocols in EAP-CREDS</name>
        <t>
   In order to use EAP-CREDS together with your favorite provisioning
   protocol, the messages from the provisioning protcol need to be sent
   to the other party.  In EAP-CREDS, this is done by encoding the
   provisioning protocol messages inside the ('Provisioning-Data') TLV.
   In case the provisioning protocol uses additional data for its
   operations (e.g., uses HTTP Headers), this data can be encoded in a
   separate ('Provisioning-Headers') TLV.</t>
        <t>
   Since the implementation of the provisioning endpoint could happen in
   a (logically or physically) different component, a method is needed
   to identify when a provisioning protocol has actually ended.  In EAP-
   CREDS, the 'D' bit in the message headers is used for this purpose.</t>
        <t>
   In the first message of Phase Two, the Server provides the client
   with all the selected parameters for one specific credential that
   needs attention (or for a new credential) to be managed by the
   network.  In particular, the server provides, at minimum, the
   ('Protocol') TLV, the ('Action') TLV, and the ('Provisioning-Params')
   or the ('Credentials-Info') TLV.</t>
        <t>
   After checking the parameters sent by the Server, if the Peer does
   not support any of the proposed ones, it MUST send a message with one
   single ('Error') TLV with the appropriate error code(s).  The server,
   can then decide if to manage a different set of credentials (if more
   where reported by the Peer in its Phase One message) or if to
   terminate the EAP session with an error.</t>
        <t>
   The Peer and the Server exchange Provisioning messages until an error
   is detected (and the appropriate error message is sent to the other
   party) or until Phase Two is successfully completed.</t>
      </section>
      <section anchor="sect-2.6" numbered="true" toc="default">
        <name>Algorithm Requirements</name>
        <t>
   EAP-CREDS uses the SHA-256 hashing algorithm to verify credentials in
   phase three of the protocol.  Peers and Servers MUST support SHA-256
   for this purpose.</t>
      </section>
      <section anchor="sect-2.7" numbered="true" toc="default">
        <name>Notation</name>
        <t>
   In this document we use the following notation in the diagrams to
   provide information about the cardinality of the data structures
   (TLVs) within EAP-CREDS messages:<!--
   draft-pala-tian-eap-creds-spp-00.txt(352): Warning: Unexpected title: expected
   'Figure ...', found 'Table 1: EAP-CREDS Notation'.  This looks like a figure
   that has been entered as a texttable.  The generated XML will need
   adjustment.
   -->
        </t>
        <figure anchor="le-eap-creds-notation">
          <name>EAP-CREDS Notation</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
+--------+------------+---------------------------------------------+
| Symbol |  Example   | Usage                                       |
+--------+------------+---------------------------------------------+
|  { }   |   {TLV1}   | Curly Brackets are used to indicate a set   |
|  [ ]   |  {[TLV2]}  | Square Brackets are used to indicate that a |
|        |            | field is optional                           |
|  ( )   | {TLV1(=V)} | Round Squares are used to specify a value   |
|   +    |  {TLV_2+}  | The Plus character indicates that one or    |
|        |            | more instances are allowed                  |
+--------+------------+---------------------------------------------+
]]></artwork>
        </figure>
      </section>
    </section>
    <section anchor="sect-3" numbered="true" toc="default">
      <name>EAP-CREDS Protocol</name>
      <t>
   In a nutshell, EAP-CREDS provides the abstraction layer on top of
   which credentials provisioning/managing protocols can be deployed
   thus enabling their use even before provisioning IP services.</t>
      <t>
   This section outlines the operation of the protocol and message
   flows.  The format of the CREDS messages is given in <xref target="sect-4" format="default"/>.</t>
      <section anchor="sect-3.1" numbered="true" toc="default">
        <name>Message Flow</name>
        <t>
   EAP-CREDS message flow is logically subdivided into three different
   phases: Initialization, Provisioning, and Validation.  EAP-CREDS
   enforces the order of phases, i.e. it is not possible to move to an
   earlier phase.</t>
        <t>
   Phase transitioning is controlled by the Server.  In particular, the
   server, after the last message of a phase, it can decide to either
   (a) start the next phase by sending the first message of the next
   phase, or (b) continue the same phase by sending another "first"
   message of the phase (e.g., managing a second set of credentials) -
   this is allowed only in Phase Two and Phase Three but NOT in Phase
   One, or (c) terminate the EAP session.</t>
        <dl newline="true" spacing="normal" indent="3">
          <dt>Phase One (Required).  Initialization.  During this phase the Peer</dt>
          <dd>
	and the Server exchange the information needed to select the
      appropriate credentials management protocol.  Phase One flow is
      composed by only messages.  In particular, the Sever sends its
      initial message of type ('EAP-CREDS-Init').  The Peer replies with
      the details about which provisioning protocols are supported, and
      additional information such as the list of installed credentials
      and, optionally, authorization data (for new credentials
      registration).
	</dd>
          <dt>Phase Two (Optional).  Provisioning Protocol Flow.  In this phase,</dt>
          <dd>
	the Peer and the Server exchange the provisioning protocol's
      messages encapsulated in a EAP-CREDS message of type Provisioning.
      The messages use two main TLVs.  The first one is the
      ('Provisioning-Headers') TLV which is optional and carries
      information that might be normally coveyed via the transport
      protocol (e.g., HTTP headers).  The second one is the
      ('Provisioning-Data'), which is required and carries the
      provisioning protocol's messages.  The server can decide to repeat
      phase two again to register new credentials or to renew a separate
      set of credentials by issuing a new ('Provisioning') message for
      the new target.  When no more credentials have to be managed, the
      Server can start phase three or simply terminate the EAP session.
	</dd>
          <dt>Phase Three (Optional).  Credentials Validation.  This optional phase</dt>
          <dd>
	can be initiated by the server and it is used to validate that the
      Peer has properly installed the credentials and can use them to
      authenticate itself.  Depending on the credentials' type, the
      messages can carry a challenge/nonce, the value of the secret/
      token, or other information.  The format of the credentials is
      supposed to be known by the provider and the device.
	</dd>
        </dl>
      </section>
      <section anchor="sect-3.2" numbered="true" toc="default">
        <name>Phase Transitioning Rules</name>
        <t>
   In order to keep track of starting and ending a phase, EAP-CREDS
   defines several bits and fields in the EAP-CREDS message headers.  In
   particular, as described in <xref target="sect-4.1" format="default"/>, the 'S' bit is used to
   indicate the beginning (or Start) of a phase, while the 'Phase' field
   (4 bits) is used to indicate the phase for this message.</t>
        <t>
   In EAP-CREDS, phase transitioning is under the sole control of the
   Server, therefore the value of the 'S' bit is meaningful only in
   messages sent by the Server.  The value of the 'S' bit in Peer's
   messages SHALL be set to '0x0' and SHALL be ignored by the server.</t>
        <t>
   When starting a new phase, the Server MUST set the 'S' bit to '1' and
   the 'Phase' field to the current phase number (e.g., one, two, or
   three).</t>
        <t>
   In case the first message of a phase is to be repeated (e.g., because
   of processing multiple credentials), the 'S' bit SHALL be set to '0'
   (i.e., it should be set to '1' only on the first occurrency and set
   to '0' in subsequent messages).</t>
      </section>
      <section anchor="sect-3.3" numbered="true" toc="default">
        <name>Phase One: Initialization</name>
        <dl newline="true" spacing="normal" indent="3">
          <dt>The following figure provides the message flow for Phase One:</dt>
          <dd/>
        </dl>
        <artwork name="" type="" align="left" alt=""><![CDATA[
        ,--------.                              ,----------.
        |EAP Peer|                              |EAP Server|
        `---+----'                              `----+-----'
           |        Outer Tunnel Established        |
           | <-------------------------------------->
           |                                        |
           | [1] EAP-Request/EAP-CREDS(Type=Init)   |  ,---------!.
           | { [ Version+ ], [ Challenge-Data ] }   |  |Phase One|_\
           | <---------------------------------------  |Begins     |
           |                                        |  `-----------'
           | [2] EAP-Response/EAP-CREDS(Type=Init)  |
           |     { [Version], [ Protocols+ ],       |
           |       [ Creds-Info+ ], [ Encoding+ ]   |  ,---------!.
           |       [ Format+ ], [ Token-Data ]      |  |Phase One|_\
           |       [ Profile+ ], [ Challenge-Rsp ]  |  |Ends       |
           |       [ Storage-Info ],[ Net-Usage] }  |  `-----------'
           | --------------------------------------->
           |                                        |
           |                                        |

                  EAP-CREDS Phase One Message Flow

[1] Server sends EAP-Request/EAP-CREDS(Type=Init):
]]></artwork>
        <dl newline="false" spacing="normal" indent="3">
          <dt/>
          <dd>
      After the establishment of the outer mechanism (e.g., EAP-TLS,
      EAP-TEAP, EAP-TTLS, etc.), the server MAY decide to start a
      credentials management session.  In order to do that, the Server
      sends an EAP-Request/EAP-CREDS(Type=Init) message to the Peer with
      the 'Phase' field sets to '0x01'.  The 'S' bit also needs to be
      set to '1', which indicates this message is the beginning of Phase
      One. Also, the Server MAY use one or more ('Version') TLVs to
      indicate the supported versions.</dd>
        </dl>
        <dl newline="false" spacing="normal" indent="3">
          <dt/>
          <dd>
      The Server MAY also specify which versions of EAP-CREDS are
      supported by adding one or more ('Version') TLVs.  If no
      ('Version') TLV is added to the message, the Peer SHOULD assume
      the supported version is 1 ('0x1').</dd>
        </dl>
        <dl newline="false" spacing="normal" indent="3">
          <dt/>
          <dd>
      Optionally, the Server MAY also send a ('Challenge-Data') TLV
      which includes chanllenge data value (usually some random value)
      and a specified challenge type, which indicates the type Peer MUST
      use for calculating the ('Challenge-Response') TLV.</dd>
        </dl>
        <dl newline="true" spacing="normal" indent="3">
          <dt>[2] The Peer sends EAP-Response/EAP-CREDS(Type=Init)</dt>
          <dd>
            <t>
	The Peer, sends back a message that carries one ('Version') TLV to
      indicate the selected version of EAP-CREDS (i.e.  from the list
      provided by the server) (optional).  If the client does not
      include the ('Version') TLV, the Server MUST use the most recent
      supported version of EAP-CREDS.  Moreover, the Server includes one
      or more ('Protocol') TLVs to indicate the list of supported
      provisioning protocols, followed by one or more ('Credentials-
      Info') TLVs for each installed credential to provide their status
      to the server (i.e., if multiple credentials are configured on the
      Peer for this Network, then the Peer MUST include one
      ('Credentials-Info') TLV for each of them).
            </t>
            <t>
	The Peer also provides the list of supported Encodings and Formats
      by adding one or more ('Encodings') and ('Formats') TLVs.
            </t>
            <t>
	When there are no abailable credentials, the Peer MAY include an
      authorization token that can be consumed by the Server for
      registering new credentials.  In particular, the Peer can include
      the ('Token-Data') TLV to convey the value of the token.  The
      ('Challenge-Data') and ('Challenge-Response') TLVs, instead, can
      be used to convey a challenge and its response based on the
      authorization information (e.g., maybe a public key hash is
      present in the Token, then the peer can generate some random data
      - or use the one from the Server - and generate a signature on
      that value: the signature SHALL be encoded in the ('Challenge-
      Response') TLV and it should be calculated over the concatenation
      of values inside the ('Challenge-Data') TLV and the ('Token-Data')
      TLV.
            </t>
            <t>
	Also, the Peer MAY add one or more ('Profile') TLVs to indicate to
      the Server which profiles are requested/supported (e.g., a pre-
      configuration MAY exist on the Peer with these ecosystem-specific
      identifiers).
            </t>
            <t>
	Ultimately, the Peer MAY include additional metadata regarding the
      status of the Peer.  To this end, the Peer can use a ('Storage-
      Info') TLV to provide the server with additional data about the
      Peer's capabilities and resources (e.g., credentials storage).
      Also, the ('Network-Usage') TLV can be used to provide the Server
      with the indication of which network resources are needed by the
      Peer and what is its intended utilization pattern(s).
            </t>
            <t>
	The server checks that the Peer's selected protocol, version, and
      parameters are supported and, if not (or if the server detects an
      error), it can (a) send a non-recoverable error message to the
      peer, notify the outer (tunneling) layer, and terminate the EAP-
      CREDS session, or (b) start phase one again by sending a new
      ('EAP-CREDS-Init') message that will also carry an ERROR TLV that
      provides the Peer with the reason the initial response was not
      acceptable.  In this case, the 'Phase' field MUST be omitted since
      it is not the first message of phase one (see <xref target="sect-3.2" format="default"/>).  The
      server and the peer can repeat phase one until they reach an
      agreement or the session is terminated by the Server.
            </t>
            <t>
	NOTE WELL: The determination of the need to start Phase Two or not
      is based on the contents of the ('Credentials-Info') TLV sent by
      the Peer (e.g., a credential is about to expire or a credential is
      simply missing).
            </t>
          </dd>
        </dl>
      </section>
      <section anchor="sect-3.4" numbered="true" toc="default">
        <name>Phase Two: Provisioning</name>
        <dl newline="true" spacing="normal" indent="3">
          <dt>The following figure provides the message flow for Phase 2:</dt>
          <dd/>
        </dl>
        <artwork name="" type="" align="left" alt=""><![CDATA[
     ,--------.                                     ,----------.
     |EAP Peer|                                     |EAP Server|
     `---+----'                                     `----+-----'
      |  [1] EAP-Request/EAP-CREDS(Type=Provisioning) |
      |      { Protocol, Action,                      |  ,---------!.
      |        [ CredInfo  ], [ Params ],             |  |Phase Two|_\
      |        [ ProtoData ], [ ProtoHeaders ] }      |  |Begins     |
      | <----------------------------------------------  `-----------'
      |                                               |
      | [2] EAP-Response/EAP-CREDS(Type=Provisioning) |
      |     { ProtoData, [ ProtoHeaders ] }           |
      | ---------------------------------------------->
      |                                               |
      .                                               .
      .                                               .
      .                                               .
      .                                               .
      | [N] EAP-Response/EAP-CREDS(Type=Provisioning) |
      |     { [ CredInfo ], [ ProtoData ],            |
      |       [ ProtoHeaders ] }                      |
      | <----------------------------------------------
      |                                               |
      | [N+1] EAP-Request/EAP-CREDS(Type=Provisioning)|  ,---------!.
      |     { [ ProtoData ], [ ProtoHeaders ] }       |  |Phase Two|_\
      | ---------------------------------------------->  |Ends       |
      |                                               |  `-----------'
      |                                               |
]]></artwork>
        <dl newline="false" spacing="normal" indent="3">
          <dt/>
          <dd>
            <t>                     EAP-CREDS Phase Two Message Flow</t>
            <dl newline="true" spacing="compact" indent="3">
              <dt>[1] The Server sends EAP-Request/EAP-CREDS(Type=Init)</dt>
              <dd/>
            </dl>
          </dd>
        </dl>
        <dl newline="false" spacing="normal" indent="3">
          <dt/>
          <dd>
      The first message of Phase Two indicates that the Server is ready
      to initiate the selected provisioning protocol.</dd>
        </dl>
        <dl newline="true" spacing="normal" indent="3">
          <dt>[2] The Peer sends EAP-Response/EAP-CREDS(Type=Init)</dt>
          <dd>
	After that, the Peer sends its first message to the Server by
      sending the EAP-Response/EAP-CREDS(Type=Provisioning) message.
      This message contains the selected provisioning protocol's message
      data and some extra fields (e.g., transport-protocol headers) in
      the ('Provisioning-Data') and ('Protocol-Headers') TLVs
      respectively.
	</dd>
          <dt>[3] The Server sends EAP-Request/EAP-CREDS(Type=Init)</dt>
          <dd>
	The Server replies to the Peer's message with EAP-Request/EAP-
      CREDS(Type=Provisioning) messages until the provisioning protocol
      reaches an end or an error condition arise (non-recoverable).
	</dd>
          <dt>[N] The Server sends EAP-Request/EAP-CREDS(Type=Provisioning)</dt>
          <dd>
	When the provisioning protocol has been executed for the specific
      set of credentials, the server sends a last message that MUST
      include the description of the provisioned credentials in a
      ('Credentials-Info') TLV and MUST set the 'D' bit in the EAP-CREDS
      message header to '1' to indicates that the server does not have
      any more ('Provisioning') messages for this credenital.  The final
      message does not need to be an empty one, i.e. other TLVs are
      still allowed in the same message (e.g., the 'Provisioning-Data'
      and the 'Provisioning-Headers' ones).
	</dd>
          <dt>[N+1] The Peer sends EAP-Request/EAP-CREDS(Type=Provisioning)</dt>
          <dd>
	The Peer MUST reply to the server with a ('Provisioning') message
      that MUST have the 'D' bit in the EAP-CREDS message header set to
      '1', thus indicating that the credentials have been installed
      correctly.  In case of errors, the Peer MUST include the
      appropriate ('Error') TLV.  Also in this case, the final message
      does not need to be an empty one, i.e. other TLVs are still
      allowed in the same message (e.g., the 'Provisioning-Data' and the
      'Provisioning-Headers' ones).
	</dd>
        </dl>
        <t>
   At this point, the Server can decide to provision (or manage) another
   set of credentials by issuing a new ('Provisioning') message, or it
   can decide to start Phase Three by sending its first ('Validate')
   message, or it can terminate the EAP session.</t>
      </section>
      <section anchor="sect-3.5" numbered="true" toc="default">
        <name>Phase Three: Validation</name>
        <dl newline="true" spacing="normal" indent="3">
          <dt>The following figure provides the message flow for Phase 3:</dt>
          <dd/>
        </dl>
        <artwork name="" type="" align="left" alt=""><![CDATA[
       ,--------.                                ,----------.
       |EAP Peer|                                |EAP Server|
       `---+----'                                `----+-----'
        | [1] EAP-Request/EAP-CREDS(Type=Validate) |  ,-----------!.
        |     { Cred-Info, Challenge-Data }        |  |Phase Three|_\
        | <-----------------------------------------  |Begins       |
        |                                          |  `-------------'
        | [2] EAP-Response/EAP-CREDS(Type=Validate)|  ,-----------!.
        |     { Challenge-Response }               |  |Phase Three|_\
        | ----------------------------------------->  |Ends         |
        |                                          |  `-------------'
        |                                          |

             EAP-CREDS Phase Three Message Flow (Basic)
]]></artwork>
        <t>
   Phase three is optional and it is usually used by the server to
   request the client to validate (proof) that the new credentials have
   been installed correctly before issuing the final Success message.
   However, it is also possible for the Peer to request the server-side
   validation for symmetric credentials.  The message flow and diagram
   of the server-side validation is listed below in this section.</t>
        <dl newline="false" spacing="normal" indent="3">
          <dt/>
          <dd>
      NOTE WELL: Phase Three introduces a dependency on the selected
      hashing algorithm to provide common and easy way to check the
      integrity and functionality of a newly installed set of
      credentials.</dd>
        </dl>
        <dl newline="true" spacing="normal" indent="3">
          <dt>[1] The Server sends EAP-Request/EAP-CREDS(Type=Validate)</dt>
          <dd>
            <t>
	In order to start Phase Three, the Server sends an EAP-Request/
      EAP-CREDS(Type=Validate) message to the Peer.  The Server MUST
      include the ('Credentials-Info') TLV to provide the indication
      about which set of credentials the Server intends to validate.
      The Server MUST also include a randomly generated challenge in the
      message to the client.  The type of challenge determines how the
      ('Challenge-Response') is calculated.  EAP-CREDS defines the
      asymmetric and symmetric challenges in <xref target="sect-8.6" format="default"/> and others can
      be defined according to the specified rules.
            </t>
            <t>
	As usual, the Server MUST set, in the headers, the 'S' bit to '1'
      in its first message of Phase Three and the 'Phase' value shall be
      set to '3' (beginning of Phase Three).
            </t>
          </dd>
          <dt>[2] The Peer sends EAP-Response/EAP-CREDS(Type=Validate)</dt>
          <dd>
            <t>
	When the client receives the Validate message from the server, it
      calculates the response to the challenge and sends the response
      back to the server in a EAP-Response/EAP-CREDS(Type=Validate)
      message.  When the EAP-CREDS-ASYMMETRIC-CHALLENGE and EAP-CREDS-
      SYMMETRIC-CHALLENGE values are used in the Challenge type, the
      Peer MUST calculate the response as follows:
            </t>
            <dl newline="true" spacing="normal" indent="3">
              <dt/>
              <dd>
                <t>         Public-Key</t>
                <t>
	For any public-key based credentials (e.g., certificates or
            raw key pairs), the response to the challenge is calculated
            by generating a signature over the hashed value of the
            challenge.  The hashing algorithm to be used for this
            purpose is specified in <xref target="sect-2.6" format="default"/>.  The format of the
            signature in the ('Challenge-Response') TLV is the
            concatenation of:
                </t>
                <ul spacing="normal">
                  <li>The signatureAlgorithm (DER encoded) which contains the
               identifier for the cryptographic algorithm used by the
               Peer to generate the signature.  [RFC3279], [RFC4055],
               and [RFC4491] list supported signature algorithms, but
               other signature algorithms MAY also be supported.  The
               definition of the signatureAlgorithm is provided in
               Section 4.1.1.2 of <xref target="RFC5280" format="default"/>.</li>
                  <li>The signatureValue (DER encoded) which contains the
               digital signature itself.  The signature value is encoded
               as a BIT STRING and the details of how to generate the
               signatures' structures can be found in Section 4.1.1.3 of
               <xref target="RFC5280" format="default"/> and referenced material.</li>
                </ul>
              </dd>
              <dt>Symmetric Secret</dt>
              <dd>
                <t>
	For any symmetric based credentials (e.g., password or Key),
            the response to the challenge is calculated by using the
            selected hash function (see <xref target="sect-2.6" format="default"/>) on the
            concatenation of (a) the value carried in the server-
            provided ('Challenge-Data') TLV, and (b) the secret value
            itself (salted hash).
                </t>
                <t>
	The initial values for the type of challenges are described in the
      <xref target="sect-8.6" format="default"/>.  Other types of challenges MAY be defined according
      to the specified procedures.
                </t>
              </dd>
            </dl>
          </dd>
        </dl>
        <artwork name="" type="" align="left" alt=""><![CDATA[
       ,--------.                                ,----------.
       |EAP Peer|                                |EAP Server|
       `---+----'                                `----+-----'
        | [1] EAP-Request/EAP-CREDS(Type=Validate) |  ,-----------!.
        |     { Cred-Info, Challenge-Data }        |  |Phase Three|_\
        | <-----------------------------------------  |Begins       |
        |                                          |  `-------------'
        | [2] EAP-Response/EAP-CREDS(Type=Validate)|
        |  { Challenge-Response, Challenge-Data }  |
        | ----------------------------------------->
        |                                          |
        | [3] EAP-Response/EAP-CREDS(Type=Validate)|  ,-----------!.
        |     { Challenge-Response }               |  |Phase Three|_\
        | <----------------------------------------|  |Ends         |
        |                                          |  `-------------'

     EAP-CREDS Phase Three Message Flow (Server-side Validation)

[1] The Server sends EAP-Request/EAP-CREDS(Type=Validate)
]]></artwork>
        <dl newline="false" spacing="normal" indent="3">
          <dt/>
          <dd>
      In order to start Phase Three, the Server sends an EAP-Request/
      EAP-CREDS(Type=Validate) message to the Peer.  The Server MUST
      include the ('Credentials-Info') TLV to provide the indication
      about which set of credentials the Server intends to validate.
      The Server MUST also include a randomly generated challenge in the
      message to the client.  The type of challenge determines how the
      ('Challenge-Response') is calculated.  EAP-CREDS defines the
      asymmetric and symmetric challenges in <xref target="sect-8.6" format="default"/> and others can
      be defined according to the specified rules.</dd>
        </dl>
        <dl newline="false" spacing="normal" indent="3">
          <dt/>
          <dd>
      As usual, the Server MUST set, in the headers, the 'S' bit to '1'
      in its first message of Phase Three and the 'Phase' value shall be
      set to '3' (beginning of Phase Three).</dd>
        </dl>
        <dl newline="true" spacing="normal" indent="3">
          <dt>[2] The Peer sends EAP-Response/EAP-CREDS(Type=Validate)</dt>
          <dd>
	When the client receives the Validate message from the server, it
      calculates the response to the challenge and sends the response
      back to the server in a EAP-Response/EAP-CREDS(Type=Validate)
      message.  Besides, the Peer MAY include ('Challenge-Data') TLV for
      the server-side validation.
	</dd>
          <dt>[3] The Server sends EAP-Request/EAP-CREDS(Type=Validate)</dt>
          <dd>
            <t>
	When the Server receives the response message from the Peer with
      ('Challenge-Data') included, the Server MUST include (if a
      symmetric secret) the response to the Peer-issued ('Challenge-
      Data') TLV by computing the response and adding it to the
      ('Challenge-Response') TLV in its reply.
            </t>
            <t>
	Finally, in the last message, the Server (if Phase Three is to be
      ended) SHALL set the 'S' bit to '0' (end of phase) and the value
      of 'Phase' field set to '0x03'.
            </t>
          </dd>
        </dl>
        <t>
   In case of issues with the validation of newly deployed credentials,
   both the Server and the Peer should consider those credentials
   invalid (or unusable) and should issue the required failure
   message(s).</t>
      </section>
    </section>
    <section anchor="sect-4" numbered="true" toc="default">
      <name>EAP-CREDS Message Format</name>
      <t>
   The EAP-CREDS defines the following message types:</t>
      <ol spacing="normal" type="1"><li>EAP-CREDS/Init</li>
        <li>EAP-CREDS/Provisioning</li>
        <li>EAP-CREDS/Validate</li>
      </ol>
      <t>
   Each of these message types have the basic structure as identified in
   <xref target="sect-4.1" format="default"/>.  EAP-CREDS messages contain zero, one, or more TLVs.
   The internal structure of the different types of TLVs is described in
   <xref target="sect-4.2" format="default"/>, while a detailed description of the EAP-CREDS message
   types is provided in <xref target="sect-5" format="default"/>.</t>
      <section anchor="sect-4.1" numbered="true" toc="default">
        <name>Message Header</name>
        <t>
   The EAP-CREDS messages consist of the standard EAP header (see
   Section 4 of <xref target="RFC3748" format="default"/>), followed by the version of the EAP-CREDS (4
   bits) and a field (4 bits) reserved for future use.  The header has
   the following structure:</t>
        <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     Code      |  Identifier   |             Length            |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     Type      |J|S|F|D| Phase |         Message Length        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |         Message Length        |               Data           ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-.
]]></artwork>
        <t>
   Where the Code, Identifier, Length, and Type fields are all part of
   the EAP header as defined in <xref target="RFC3748" format="default"/>.  Since EAP-CREDS can only be
   used as a tunneled mechanism, the presence of these fields is only
   for backward compatibility with existing parsers.  In particular, the
   'Length' field is not used (can be ignored): the message length is
   carried in the 'Message Length' field instead.</t>
        <t>
   The Type field in the EAP header is &lt;TBD&gt; for EAP-CREDS.</t>
        <t>
   The Flags bitfield is used to convey status information (e.g., extra
   long message, phase number, phase transitioning state).  The
   transition-control bit (i.e., the 'S' bit) are set in Server's
   messages and are ignored in Peer's messages (the Server is the entity
   that unilaterally controls the phase transition process).  The
   meanins of the bits in the 'Flags' field are as follows:</t>
        <dl newline="false" spacing="normal" indent="3">
          <dt/>
          <dd>
      Bit 'J' (Jumbo Message) - If set, it idicates the presence of the
      'Message Length' field.  This bit SHALL be used only when the size
      of the message exceeds the maximum value allowed in the 'Length'
      field.  In this case, the 'Message Length' field is added to the
      message and set to the whole message size and the 'Length' field
      is used for the current fragment length.  If not set, the 'Message
      Length' field is not present in the Message and the 'Length' field
      is used for the message size (and the 'F' bit MUST be set to '0').</dd>
        </dl>
        <dl newline="false" spacing="normal" indent="3">
          <dt/>
          <dd>
      Bit 'S' (Start) - If set, this message is the first one of a new
      EAP-CREDS phase.  The value of the new phase is encoded in the
      'Phase' field.</dd>
        </dl>
        <dl newline="false" spacing="normal" indent="3">
          <dt/>
          <dd>
      Bit 'F' - If set, this message is a fragment of a message.  In
      this case, the 'Data' field is to be concatenated with all
      messages with the 'F' bit set to '1' until the message with the
      'F' bit set to '0' that indicates the end of the message.  If the
      message is not fragmented, the 'F' bit MUST be set to '0'.  The
      use of this bit is required when the tunneling method does not
      provide support for messages up to 2^32 bits in size.</dd>
        </dl>
        <dl newline="false" spacing="normal" indent="3">
          <dt/>
          <dd>
      Bit 'D' - This bit is used in Phase Two and Phase Three to
      indicate that the specific operation for the identified credential
      is over.  For example, when multiple credentials exist on the Peer
      and the Server needs to manage and validate one of them.  In its
      last message, when the provisioning protocol is done, the server
      sets the 'D' (Done) bit to indicate that it is done.  The Peer, in
      its reply, sets the bit to indicate the end of provisioning for
      this credentials is also over.  After that, the Server can
      continue Phase Two, transition to Phase Three, or terminate the
      EAP session.</dd>
        </dl>
        <t>
   The Phase field is a 4-bits value and identifies the EAP-CREDS phase
   for the current message.  The version of EAP-CREDS described in this
   document supports three values for this field:</t>
        <dl newline="false" spacing="normal" indent="3">
          <dt/>
          <dd>
      0x01 - Phase One</dd>
        </dl>
        <dl newline="false" spacing="normal" indent="3">
          <dt/>
          <dd>
      0x02 - Phase Two</dd>
        </dl>
        <dl newline="false" spacing="normal" indent="3">
          <dt/>
          <dd>
      0x03 - Phase Three</dd>
        </dl>
        <t>
   A detailed explanation of the 'Phase' and 'Flags' fields of the
   message headers is provided in <xref target="sect-3.2" format="default"/>.</t>
        <t>
   The Data field is the message payload.  The full description of this
   field is provided in the next section.</t>
      </section>
      <section anchor="sect-4.2" numbered="true" toc="default">
        <name>Message Payload</name>
        <t>
   The Data part of the message is organized as zero, one, or more TLV
   objects whose structure is defined in this section.</t>
        <t>
   Each TLV object has the same basic structure that is defined as
   follows:</t>
        <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                   TLV Length                  |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                       TLV Value                              ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Where:

TLV-Type (uint8)
]]></artwork>
        <dl newline="false" spacing="normal" indent="3">
          <dt/>
          <dd>
      This field is used to indicate the type of data that the TLV
      carries.  The type of TLV determines its internal structure.  The
      supported values for this fields are provided in the following
      table:</dd>
        </dl>
        <dl newline="true" spacing="normal" indent="3">
          <dt>Length (uint24)</dt>
          <dd>
	This field carries the size of the value of the TLV.  In
      particular, the overall size of a TLV (i.e., the header plus the
      value) can be calculated by adding the size of the header (6
      octects) to the value of the Length field (i.e., the size of the
      TLV's value).
	</dd>
        </dl>
        <table anchor="tab-eap-creds-supported-tlvs-types" align="center">
          <name>EAP-CREDS Supported TLVs Types</name>
          <thead>
            <tr>
              <th align="left"> TLV Name</th>
              <th align="left"> TLV Type</th>
              <th align="left"> Scope/Usage</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Action TLV</td>
              <td align="left">Phase Two</td>
            </tr>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Certificate-Data TLV</td>
              <td align="left">Phase Two/SPP</td>
            </tr>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Challenge-Data TLV</td>
              <td align="left">Phase Two, Phase Three</td>
            </tr>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Challenge-Response TLV</td>
              <td align="left">Phase Two, Phase Three</td>
            </tr>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Credentials-Data TLV</td>
              <td align="left">Phase Two/SPP</td>
            </tr>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Credentials-Info TLV</td>
              <td align="left">Phase Two, Phase Three</td>
            </tr>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Error TLV</td>
              <td align="left">All Phases</td>
            </tr>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Network-Usage TLV</td>
              <td align="left">Phase One</td>
            </tr>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Profile TLV</td>
              <td align="left">Phase Two</td>
            </tr>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Protocol TLV</td>
              <td align="left">Phase One, Phase Two</td>
            </tr>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Provisioning-Data TLV</td>
              <td align="left">Phase Two</td>
            </tr>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Provisioning-Headers TLV</td>
              <td align="left">Phase Two</td>
            </tr>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Provisioning-Params TLV</td>
              <td align="left">Phase Two</td>
            </tr>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Certificate-Request TLV</td>
              <td align="left">SPP</td>
            </tr>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Storage-Info TLV</td>
              <td align="left">SPP</td>
            </tr>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Supported-Format TLV</td>
              <td align="left">SPP</td>
            </tr>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Supported-Encoding TLV</td>
              <td align="left">SPP</td>
            </tr>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Token-Data TLV</td>
              <td align="left">Phase One</td>
            </tr>
            <tr>
              <td align="left">&lt;TBD&gt;</td>
              <td align="left">Version TLV</td>
              <td align="left">Phase One</td>
            </tr>
          </tbody>
        </table>
        <dl newline="true" spacing="normal" indent="3">
          <dt>TLV Value ( &gt; 1 octet )</dt>
          <dd>
	This field carries data for the identified TLV.  The internal
      structure is determined by the TLV Type field.
	</dd>
        </dl>
        <t>
   The rest of this section describes the structure of the different
   supported TLVs and their usage in the different messages.</t>
      </section>
      <section anchor="sect-4.3" numbered="true" toc="default">
        <name>EAP-CREDS defined TLVs</name>
        <t>
   EAP-CREDS messages's payload comprieses zero, one, or more TLVs that
   are encoded in a single EAP-CREDS message.  The values for the TLV
   Type that are supported by this specifications are listed in Table 2.</t>
        <section anchor="sect-4.3.1" numbered="true" toc="default">
          <name>The Action TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |   TLV Type    |                 TLV Length                    |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Flags     |  Action Type  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   <TBD> - Action TLV

TLV Length (uint24)

   Fixed value (=2)

Flags (uint8)

   Reserved
]]></artwork>
        </section>
        <section anchor="sect-4.3.2" numbered="true" toc="default">
          <name>The Certificate-Data TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     Flags     |    Encoding     |            Value           ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   <TBD> - Certificate-Data TLV

Length (uint24)

   Provides the length of the TLV (> 3 octets)

Flags (uint8)
]]></artwork>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      Provides a BITMASK that can be used to provide additional
      information related to the encapsulated certificate.  The bits
      have the following meaning:</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="6">
            <dt/>
            <dd>
         Bit 0 - If set, the certificate is trusted (Trust Anchor)
         Bit 1 - If set, the certificate is a CA certificate</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="6">
            <dt/>
            <dd>
         Bit 2 - If set, the certificate is self-signed</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="6">
            <dt/>
            <dd>
         Bit 3 - If set, the certificate is a proxy certificate</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="6">
            <dt/>
            <dd>
         Bit 4 - If set, the certificate is an attribute certificate</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="6">
            <dt/>
            <dd>
         Bit 5 - Reserved</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="6">
            <dt/>
            <dd>
         Bit 6 - Reserved</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="6">
            <dt/>
            <dd>
         Bit 7 - Reserved</dd>
          </dl>
          <t>
   For a Trusted Root CA, the value of the flags shall be 0x7 (0000
   0111).  For an intermediate CA certificate that is not implicitly
   trusted, the value of the flags field should be set to 0x02 (0000
   0010).  For an End-Entity certificate, the value of the Flags will be
   0x0 (0000 0000).</t>
          <dl newline="true" spacing="normal" indent="3">
            <dt>Format (uint8)</dt>
            <dd>
	Provides the indication of the Format the certificate is in.  The
      allowed values for this field are listed in <xref target="sect-8.5" format="default"/>.
	</dd>
            <dt>Encoding (uint8)</dt>
            <dd>
	Provides the indication of the Encoding the certificate is in.
      The allowed values for this field are listed in <xref target="sect-8.8" format="default"/>.
	</dd>
            <dt>Value (octet string)</dt>
            <dd>
	This field carries the data for the certificate.
	</dd>
          </dl>
        </section>
        <section anchor="sect-4.3.3" numbered="true" toc="default">
          <name>The Challenge-Data TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   Ch. Type    |           Challenge Data                     ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   <TBD> - Challenge-Data TLV

Length (uint24)

   3 octets

Challenge Type (uint8).
]]></artwork>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      This field carries the type of Challenge.  In particular, the
      challenge type determines how the Peer MUST calculate the
      ('Challenge-Response').  The initial values for this fiel are
      listed in <xref target="sect-8.6" format="default"/>.  Please refer to <xref target="sect-3.5" format="default"/> for a detailed
      explanation of how to calculate the response to the challenge for
      the challenge types defined in this document.</dd>
          </dl>
          <dl newline="true" spacing="normal" indent="3">
            <dt>Challenge Data (&gt; 1 octet)</dt>
            <dd>
	This field carries the data to be used as a challenge when
      validating newly deployed credentials.
	</dd>
          </dl>
        </section>
        <section anchor="sect-4.3.4" numbered="true" toc="default">
          <name>The Challenge-Response TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                       Challenge Response                     ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   <TBD> - Challenge-Response TLV

Length (uint24)

   3 octets

Challenge Response (> 1 octet)
]]></artwork>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      This field carries the data that resulted from the use of the
      credentials to be validated.</dd>
          </dl>
        </section>
        <section anchor="sect-4.3.5" numbered="true" toc="default">
          <name>The Credentials-Information TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     Flags     |   CredsType   |             ProtoID           |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 |                         IssuedOn (GMT)                        |
 |                                                               |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 |                        Expires On (GMT)                       |
 |                                                               |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                       Credentials Length                      |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                           CredIDValue                        ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          <t>
   The Credential-Information TLV is used by the Peer to provide a
   description of the installed credentials that are relevant for the
   network that is being accessed.</t>
          <t>
   For example, when a set of credentials need to be renewed, the server
   checks the ('Credentials-Info') from the Peer and eventually selects
   the right one for renewal.  The TLV structure is as follows:</t>
          <dl newline="true" spacing="normal" indent="3">
            <dt>TLV Type (uint8)</dt>
            <dd>
	&lt;TBD&gt; - Credentials-Information TLV
	</dd>
            <dt>Length (uint24)</dt>
            <dd>
	Provides the total length of the body of the Credential-
      Information TLV.
	</dd>
            <dt>Flags (uint8)</dt>
            <dd>
              <t>
	Provides a BITMASK that can be used to provide information about
      the status of the credentials (e.g., if the use marks the
      credentials to be compromised).  The bits have the following
      meaning:
              </t>
              <t>
	Bit 0 - If set, the credential is marked as compromised
              </t>
              <t>
	Bit 1 - If set, the credential is immutable and cannot be
         updated
              </t>
              <t>
	Bit 2 - Private Key or Secret Immutable, the public part of the
         credential (e.g., a certificate) can still be updated
              </t>
              <t>
	Bit 3 - If set, the credential cannot be updated (both public
         and private parts)
              </t>
              <t>
	Bit 4 - If set, the credential is ready to be used
              </t>
              <t>
	Bit 5 - If set, the credential was generated on the server
              </t>
              <t>
	Bit 6 - If set, the Peer would like to update the credential
         even if they are not expired
              </t>
              <t>
	Bit 7 - Reserved
              </t>
            </dd>
            <dt>CredType (uint8)</dt>
            <dd>
	This field provides the description of the type of credential.
      The type of credentials are listed in <xref target="sect-8.3" format="default"/>
            </dd>
            <dt>ProtoID (uint16)</dt>
            <dd>
	This field indicates the protocol that was used to retrieve the
      target credential.  When the TLV is used in a Request by the
      Server, this field is ignored.  The values for this field are
      listed in <xref target="sect-8.1" format="default"/>.
	</dd>
            <dt>IssuedOn (16 octets)</dt>
            <dd>
              <t>
	This field carries the GMT date for when this credential was
      issued.  This field is 16 bytes long (the last byte must be set to
      '0x00') and contains the NULL-terminated ASCII string that
      represents the timestamp where the credential was issued.  When
      the value is not set, the field should be set to { 0x00 }. The
      format of the string is as follows:
              </t>
              <t>
	YYYYMMDDHHmmssZ
              </t>
              <dl newline="true" spacing="normal" indent="3">
                <dt>Where:</dt>
                <dd>
                  <t>
	YYYY - is the 4 digits representation of the year
                  </t>
                  <t>
	MM - is the 2 digits representation of the month
                  </t>
                  <t>
	DD - is the 2 digits representation of the day of the month
                  </t>
                  <t>
	HH - is the 2 digits representation of the hour of the day (24
         hour format)
                  </t>
                  <t>
	mm - is the 2 digits representation of the minutes of the hour
                  </t>
                  <t>
	ss - is the 2 digits representation of the seconds of the
         minute
                  </t>
                  <t>
	Z - is the character 'Z'
                  </t>
                </dd>
              </dl>
            </dd>
            <dt>ExpiresOn (16 octets)</dt>
            <dd>
	This field carries the GMT date for when this credential is to be
      considered expired.  This field is 16 bytes long (the last byte
      must be set to '0x00') and contains the NULL-terminated ASCII
      string that represents the timestamp where the credential was
      issued.  The format is the same as the ('IssuedOn') field.  When
      the value is not set, the field should be set to { 0x00 }.
	</dd>
            <dt>Credentials Length (uint16)</dt>
            <dd>
	Length (in bytes) of the Credentials value.  When used with a
      public-key type of credentials, this is the size of the key (e.g.,
      for an RSA 2048 bit keys, this field should carry the value of
      256).  When used with a symmetric secret, this field carries the
      size of the secred (in bytes).
	</dd>
            <dt>CredIDValue (&gt; 1 octet)</dt>
            <dd>
	The binary value of the credentials' identifier.  This identifier
      can be the binary value of the SHA-256 calculated over the
      certificate, a username, or it could be a random handle.  As long
      as the ID allows the peer and the server to uniquely (in its
      context) identify the credentials, the value of this field can be
      calculated in any way.
	</dd>
          </dl>
        </section>
        <section anchor="sect-4.3.6" numbered="true" toc="default">
          <name>The Credentials-Data TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   Cred Type   |     Format    |    Encoding     |     Value  ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   <TBD> - Credentials-Data TLV

Length (uint24)

   Provides the length of the TLV (> 3 octets)

Cred Type (uint8)
]]></artwork>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      Provides the indication of the type of credentials.  The allowed
      values for this field are listed in <xref target="sect-8.3" format="default"/>.</dd>
          </dl>
          <dl newline="true" spacing="normal" indent="3">
            <dt>Format (uint8)</dt>
            <dd>
	Provides the indication of the Format the credentials are in.  The
      allowed values for this field are listed in <xref target="sect-8.5" format="default"/>.
	</dd>
            <dt>Encoding (uint8)</dt>
            <dd>
	Provides the indication of the Encoding the credentials are in.
      The allowed values for this field are listed in <xref target="sect-8.8" format="default"/>.
	</dd>
            <dt>Value (octet string)</dt>
            <dd>
	This field carries the data for the credentials.
	</dd>
          </dl>
        </section>
        <section anchor="sect-4.3.7" numbered="true" toc="default">
          <name>The Error TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     EAP-CREDS Error Code      |      Secondary Error Code     |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                          Description                         ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   <TBD> - Challenge-Response-Data TLV

Length (uint24)

   3 octets

EAP-CREDS Error Code (2 octets)
]]></artwork>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      This field carries the EAP-CREDS error code.  These code are
      related to the EAP-CREDS operations only and it should not be used
      to carry the Provisioning-Protocol specific error codes.</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      The error codes supported by this specifications are listed in
      <xref target="sect-4.3.7" format="default"/>.</dd>
          </dl>
          <dl newline="true" spacing="normal" indent="3">
            <dt>Secondary Error Code (2 octets)</dt>
            <dd>
	This field is used to convery an error at the encapsulation layer
      (i.e., the provisioning protocol error).  For example, this field
      can be used to convey a transport protocol error code (e.g., HTTP
      status code).  Do not use this field to convery EAP-CREDS specific
      errors.
	</dd>
            <dt>Description ( &gt; 1 octet)</dt>
            <dd>
	The Description field is optional (i.e., when the Description Size
      is set to zero) and carries information about the error that
      occurred.  The message may or may not be used by a user or an
      automated process for debugging purposes.
	</dd>
          </dl>
        </section>
        <section anchor="sect-4.3.8" numbered="true" toc="default">
          <name>The Network-Usage TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |U| Desc Format |   Encoding    |   Network-Usage Data         ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   <TBD> - Network-Usage TLV

Length (uint24)

   Variable Length TLV (Value must be > 2 )

Description Format (uint8)
]]></artwork>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      The Type of data encoded in the Peer Description Data.  The
      initial values for this field are listed in <xref target="sect-8.10" format="default"/>.</dd>
          </dl>
          <dl newline="true" spacing="normal" indent="3">
            <dt>Encoding (uint8)</dt>
            <dd>
	Provides the indication of the Encoding the network usage
      description data is in.  The allowed values for this field are
      listed in <xref target="sect-8.8" format="default"/>.
	</dd>
            <dt>The 'U' field (1 bit)</dt>
            <dd>
              <t>
	The 'URL' bit ('U') is used to indicate if the value of the
      Network-Usage Data field is to be interpreted as a URL or as the
      actual data.  In particular, if the value in the 'URL' bit is '1',
      then the value in the Network-Usage Data field is to be
      interpreted as the URL where the actual data can be downloaded
      from.  Otherwise, if the 'URL' bit is set to '0', then the value
      in the Netowrk-Usage Data field is to be interpreted as the actual
      data (not a URL referencing it).
              </t>
              <t>
	An example use of this bit is when the Peer wants to convey the
      URL of the MUD file <xref target="RFC8520" format="default"/>.  In this case, the Peer can set the
      Network-Usage Data field to the Url of the MUD file related to the
      Peer.
              </t>
            </dd>
            <dt>Desc Format (7 bits)</dt>
            <dd>
              <t>
	This field provide the expected data format for the Network-Usage
      Data.  For example, the value in this field could be set to 'MUD'
      and have the 'U' bit set to '1' to provide the MUD-related
      information at credentials management time instead of at network-
      provisioning time (DHCP option).  This possibility could help the
      Network controller to decide if the device shall be allowed to
      register its credentials or not.
              </t>
              <t>
	The list of initial values for this field is provided in
      <xref target="sect-8.7" format="default"/>.
              </t>
            </dd>
            <dt>Network-Usage Data (octet string)</dt>
            <dd>
              <t>
	This is additional information related to the device.  In
      particular, this TLV can be used by the Peer to provide the Server
      with the description of the intended network usage or a URL that
      points to the same information.
              </t>
              <t>
	For example, this field can be used to convey a MUD file
      (Manufacturer Usage Description) or the latest firmware-update
      manifest.
              </t>
            </dd>
          </dl>
        </section>
        <section anchor="sect-4.3.9" numbered="true" toc="default">
          <name>The Profile TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                    Profile Identifying Data                  ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   <TBD> - Profile Identifying Data TLV

Length (uint24)

   Length value should be >= 1

Profile Identifying Data (octet string)
]]></artwork>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      The Profile Identifying Data is used to provide indication to the
      other party about which profiles are supported when requesting
      credentials management.</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      Also in this case, the data used in this field is left to be
      interpreted by the end-point and it is orthogonal to EAP-CREDS
      data types.</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      An example of values for this field, an end-point could use the
      string representation (i.e., dotted representation) of the Object
      Identifier (OID) of the specific profile supported (e.g., could be
      defined in the Certificate Policy of the credentials' provider).</dd>
          </dl>
        </section>
        <section anchor="sect-4.3.10" numbered="true" toc="default">
          <name>The Protocol TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |         Protocol ID           |             Version           |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   <TBD> - Protocol TLV

TLV Length (uint24)

   Fixed TLV Length value of 4.

Protocol ID (uint16)
]]></artwork>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      The Protocol ID value carries the id of a supported provisioning
      protocol.  The initial list of values for the provisioning
      protocol identifiers can be found in <xref target="sect-8.1" format="default"/>.</dd>
          </dl>
          <dl newline="true" spacing="normal" indent="3">
            <dt>Version (uint16)</dt>
            <dd>
	The Version (Protocol Version) value represents the specific
      version of the identified provisioning protocol.  When no version
      is specified for a protocol (i.e., either it does not support
      multiple versions or it does not matter), the value of this field
      should be set to '0x0'.
	</dd>
          </dl>
        </section>
        <section anchor="sect-4.3.11" numbered="true" toc="default">
          <name>The Provisioning-Data TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                         Provisioning Data                    ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   <TBD> - Provisioning-Data TLV

Length (uint24)

   3 octets

Headers Data (> 1 octet)

   This field carries the provisioning protocol's messages.
]]></artwork>
        </section>
        <section anchor="sect-4.3.12" numbered="true" toc="default">
          <name>The Provisioning-Headers TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                           Headers Data                       ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   <TBD> - Provisioning-Headers TLV

Length (uint24)

   3 octets

Headers Data (> 1 octet)
]]></artwork>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      This field carries the meta-data (if any) that might be associated
      with the transport-layer normally used with the provisioning
      protocol.  For example, this TLV can carry the set of HTTP headers
      required by EST or ACME.</dd>
          </dl>
        </section>
        <section anchor="sect-4.3.13" numbered="true" toc="default">
          <name>The Provisioning-Params TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |            Min Length         |          Max Length           |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   Algorithm   |     Flags     |     OBJECT IDENTIFIER (DER)  ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   <TBD> - Provisioning-Params TLV

Length (uint24)

   Provides the length of the TLV (>= 6 octets)

Min Length (uint16)
]]></artwork>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      Provides the minimum allowed size size for the credentials.  This
      value has meaning depending on the context of the credentials,
      however sizes are always expressed in bytes.</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      For example, when used with a symmetric key or a password, the
      ('Min Length') and ('Max Length') refer to the minimum and maximum
      size of the password data.  The ('Algor OID') field can be omitted
      in this case.</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      On the other hand, when referring public-key credentials, this
      field should carry the size of the modulus of the key.  For
      example, for an RSA 2048 bit keys, the field should carry the
      value of 256.  For an ECDSA that uses the prime256r1 curve, this
      field should carry the value of 32 and the Algor OID should be the
      DER representation of the specific value of the curve (i.e., the
      DER representation of '1.2.840.10045.3.1.7').</dd>
          </dl>
          <dl newline="true" spacing="normal" indent="3">
            <dt>Max Length (uint16)</dt>
            <dd>
              <t>
	Provides the indication maximum size of the credentials.  This
      value has meaning depending on the context of the credentials,
      however sizes are always expressed in bytes.
              </t>
              <t>
	The same considerations apply to this field as well as the ('Min
      Length') one discussed above.
              </t>
            </dd>
            <dt>Flags (uint8)</dt>
            <dd>
              <t>
	Provides a BITMASK that can be used to provide information about
      the status of the credentials (e.g., if the use marks the
      credentials to be compromised).  The bits have the following
      meaning:
              </t>
              <t>
	Bit 0 - Credentials (or part of it) are to be generated on the
         server
              </t>
              <t>
	Bit 1 - Credentials (or part of it) are to be generated on the
         peer
              </t>
              <t>
	Bit 2 - Credentials are to be generated on dedicated hardware
              </t>
              <t>
	Bit 3 - Reserved
              </t>
              <t>
	Bit 4 - Reserved
              </t>
              <t>
	Bit 5 - Reserved
              </t>
              <t>
	Bit 6 - Reserved
              </t>
              <t>
	Bit 7 - Reserved
              </t>
              <t>
	When using public-key based credentials, the bits 0 and 1 are
      mutually exclusive.
              </t>
              <t>
	When using passwords or shared secrets, if bit 0 is set, then the
      secret is generated by the server and then sent to the client.  On
      the other hand, if bit 1 is set, then the secret is generated by
      the peer and then sent to the server.  Ultimately, if both bits
      are set, then the Server generates the first part of the password
      and sends it to the Peer, while the Peer generates the second part
      of the password and sends it to the Server.  The password to be
      used for future authentication is the concatenation of the two
      shares of the password: first the one from the Server, then the
      one from the Client.
              </t>
              <t>
	NOTE WELL: Last but not least, since these passwords/secrets
         are meant to be used in a automated fashion, there is no
         restriction around the character set to use or their
         interpretation.  Therefore,it is good practice to generate
         random passphrases that use the full 8-bit character set (on
         client and server) to maximize the secret's search space.
              </t>
            </dd>
            <dt>Algorithm (uint8)</dt>
            <dd>
	Provides the indication of the algorithm used for the generation
      of the credentials.  The allowed values for this field are listed
      in <xref target="sect-8.4" format="default"/>.
	</dd>
            <dt>Object Identifier (binary; &gt; 1 octet)</dt>
            <dd>
	Provides the indication of additional parameters that are needed
      to be encoded for the credentials.  This value is used only when
      the credentials use public-key cryptography - this field carries
      additional information about the generation algorithm to be used.
      We provide some useful values that can be used as reference:
	</dd>
          </dl>
          <table anchor="tab-object-identifiers-examples" align="center">
            <name>Object Identifiers Examples</name>
            <thead>
              <tr>
                <th align="left"> OID Name </th>
                <th align="left"> Dotted Representation</th>
                <th align="left"> Binary Encoding </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">secp256r1</td>
                <td align="left">1.2.840.10045.3.1.7</td>
                <td align="left">06 08 2A 86 48 CE 3D 03</td>
              </tr>
              <tr>
                <td align="left">curve</td>
                <td align="left"/>
                <td align="left">01 07</td>
              </tr>
              <tr>
                <td align="left">secp384r1</td>
                <td align="left">1.2.840.10045.3.1.34</td>
                <td align="left">06 08 2A 86 48 CE 3D 03</td>
              </tr>
              <tr>
                <td align="left">curve</td>
                <td align="left"/>
                <td align="left">01 22</td>
              </tr>
              <tr>
                <td align="left">secp521r1</td>
                <td align="left">1.2.840.10045.3.1.35</td>
                <td align="left">06 08 2A 86 48 CE 3D 03</td>
              </tr>
              <tr>
                <td align="left">curve</td>
                <td align="left"/>
                <td align="left">01 23</td>
              </tr>
              <tr>
                <td align="left">X25519 curve</td>
                <td align="left">1.3.101.110</td>
                <td align="left">06 03 2B 65 6E</td>
              </tr>
              <tr>
                <td align="left">X25519 curve</td>
                <td align="left">1.3.101.110</td>
                <td align="left">06 03 2B 65 6E</td>
              </tr>
              <tr>
                <td align="left">X448 curve</td>
                <td align="left">1.3.101.111</td>
                <td align="left">06 03 2B 65 6F</td>
              </tr>
              <tr>
                <td align="left">Ed25519 curve</td>
                <td align="left">1.3.101.112</td>
                <td align="left">06 03 2B 65 70</td>
              </tr>
              <tr>
                <td align="left">Ed448 curve</td>
                <td align="left">1.3.101.113</td>
                <td align="left">06 03 2B 65 71</td>
              </tr>
            </tbody>
          </table>
        </section>
        <section anchor="sect-4.3.14" numbered="true" toc="default">
          <name>The Certificate-Request TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   Encoding    |    Format     |            Value             ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   <TBD> - Token-Data TLV

TLV Length (uint24)

   Provides the length of the TLV (> 3 octets)

Encoding (uint8)
]]></artwork>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      Provides the indication of the Encoding the credentials are in.
      The allowed values for this field are listed in <xref target="sect-8.8" format="default"/>.</dd>
          </dl>
          <dl newline="true" spacing="normal" indent="3">
            <dt>Format (uint8)</dt>
            <dd>
	Provides the indication of the type of credentials.  The allowed
      values for this field are listed in <xref target="sect-8.5" format="default"/>.
	</dd>
            <dt>Value (octet string)</dt>
            <dd>
	This field carries the data for the credentials.
	</dd>
          </dl>
        </section>
        <section anchor="sect-4.3.15" numbered="true" toc="default">
          <name>The Storage-Info TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |     Flags     |           Spare Slots         |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                          Available Memory                     |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   <TBD> - Store-Info TLV

Flags (8 bits)
]]></artwork>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      Provides information about the status and type of store and
      limited information about its capabilities.  The bits have the
      following meaning:</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="6">
            <dt/>
            <dd>
         Bit 0 - If set, the store supports RSA keys (software)</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="6">
            <dt/>
            <dd>
         Bit 1 - If set, the store supports RSA keys (hardware)
         Bit 2 - If set, the store supports ECDSA keys (software)</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="6">
            <dt/>
            <dd>
         Bit 3 - If set, the store supports ECDSA keys (hardware)</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="6">
            <dt/>
            <dd>
         Bit 4 - If set, the store supports symmetric keys</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="6">
            <dt/>
            <dd>
         Bit 5 - If set, the store supports generic tokens</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="6">
            <dt/>
            <dd>
         Bit 6 - If set, the store is immutable (no key generation or
         deletion)</dd>
          </dl>
          <dl newline="false" spacing="normal" indent="6">
            <dt/>
            <dd>
         Bit 7 - Not Used</dd>
          </dl>
          <dl newline="true" spacing="normal" indent="3">
            <dt>Spare Slots (uint16)</dt>
            <dd>
	Provides the number of available slots where to store credentials.
      When no more slots are available, the value of '0' should be used
      to indicate to the Server that a credential must be deleted before
      a new one can be created.
	</dd>
          </dl>
          <artwork name="" type="" align="left" alt=""><![CDATA[
   When the number of slots is not fixed or not known, the value of {
   0xFF, 0xFF } shall be used.

Available Memory (uint32)
]]></artwork>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      This field carries the size (in bytes) of the spare memory on the
      Peer's secrets' store.</dd>
          </dl>
        </section>
        <section anchor="sect-4.3.16" numbered="true" toc="default">
          <name>The Formats TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |    TLV Type   |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     Format    |
 +-+-+-+-+-+-+-+-+

TLV Type (uint8)

   <TBD> - Supported-Format TLV

TLV Length (uint24)
]]></artwork>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      Provides the length of the TLV.  This field must be set to 1.</dd>
          </dl>
          <dl newline="true" spacing="normal" indent="3">
            <dt>Format (uint8)</dt>
            <dd>
	Provides the details about the supported format.  Multiple formats
      TLVs can be used in the Peer's ('Init') message to provide the
      Server with the Peer's capabilities.
	</dd>
          </dl>
        </section>
        <section anchor="sect-4.3.17" numbered="true" toc="default">
          <name>The Supported-Encoding TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   Encoding    |
 +-+-+-+-+-+-+-+-+

TLV Type (uint8)

   <TBD> - Store-Info TLV

TLV Length (uint24)
]]></artwork>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      Provides the length of the TLV.  The field has a fixed value of 1.</dd>
          </dl>
          <dl newline="true" spacing="normal" indent="3">
            <dt>Encoding (uint8)</dt>
            <dd>
	Provides the indication of the supported Encoding by the End
      Point.  This provides the indication to the Server of the
      capability of the Peer.  The allowed values for this field are
      listed in <xref target="sect-8.8" format="default"/>.
	</dd>
          </dl>
        </section>
        <section anchor="sect-4.3.18" numbered="true" toc="default">
          <name>The Token-Data TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |  Token Type   |    Encoding   |             Value            ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

TLV Type (uint8)

   <TBD> - Token-Data TLV

TLV Length (uint24)

   Provides the length of the TLV (> 3 octets)

Token Type (uint8)
]]></artwork>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      Provides the indication of the type of credentials.  The allowed
      values for this field are listed in <xref target="sect-8.2" format="default"/>.</dd>
          </dl>
          <dl newline="true" spacing="normal" indent="3">
            <dt>Encoding (uint8)</dt>
            <dd>
	Provides the indication of the Encoding the credentials are in.
      The allowed values for this field are listed in <xref target="sect-8.8" format="default"/>.
	</dd>
            <dt>Value (octet string)</dt>
            <dd>
	This field carries the data for the credentials.
	</dd>
          </dl>
        </section>
        <section anchor="sect-4.3.19" numbered="true" toc="default">
          <name>The Version TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   TLV Type    |                  TLV Length                   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |   Version     |
 +-+-+-+-+-+-+-+-+

TLV Type (uint8)

   <TBD> - Version TLV

TLV Length (uint24)
]]></artwork>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      Provides the length of the TLV.  The field has a fixed value of 1.</dd>
          </dl>
          <dl newline="true" spacing="normal" indent="3">
            <dt>Version (uint8)</dt>
            <dd>
              <t>
	The Version field represents the specific version of the EAP-CREDS
      protocol that are supported by the end point.  When multiple
      versions of EAP-CREDS are supported, multiple ('Version') TLVs can
      be used.
              </t>
              <t>
	When no version is specified (i.e., either it does not support
      multiple versions or it does not matter), the value of this field
      should be set to '0x0' (any version).
              </t>
            </dd>
          </dl>
        </section>
      </section>
    </section>
    <section anchor="sect-5" numbered="true" toc="default">
      <name>EAP-CREDS Messages</name>
      <t>
   This section describes each message and what TLVs are allowed or
   required.  EAP-CREDS defines the following values for the Message
   Type (Type):</t>
      <table anchor="tab-eap-creds-message-types" align="center">
        <name>EAP-CREDS Message Types</name>
        <thead>
          <tr>
            <th align="left"> Message Type</th>
            <th align="left"> Name </th>
            <th align="left"> Description </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">0</td>
            <td align="left">EAP-CREDS-Init</td>
            <td align="left">Initialization Phase</td>
          </tr>
          <tr>
            <td align="left">1</td>
            <td align="left">EAP-CREDS-Provisioning</td>
            <td align="left">Carries Provisioning</td>
          </tr>
          <tr>
            <td align="left"/>
            <td align="left"/>
            <td align="left">Protocol Messages</td>
          </tr>
          <tr>
            <td align="left">2</td>
            <td align="left">EAP-CREDS-Validate</td>
            <td align="left">Validates newly installed</td>
          </tr>
          <tr>
            <td align="left"/>
            <td align="left"/>
            <td align="left">credentials</td>
          </tr>
        </tbody>
      </table>
      <section anchor="sect-5.1" numbered="true" toc="default">
        <name>The EAP-CREDS-Init Message</name>
        <t>
   The EAP-CREDS-Init message type is used in Phase One only of EAP-
   CREDS.  The message flow is depicted in <xref target="sect-3.3" format="default"/>.  This message
   supports the following TLVs: Version, Protocol, Credentials-Info, and
   Error.</t>
        <section anchor="sect-5.1.1" numbered="true" toc="default">
          <name>EAP Server's Init Message</name>
          <t>
   EAP-CREDS starts with an ('EAP-CREDS-Init') message from the server.
   This message MAY contain zero, one, or more ('Version') TLVs and,
   optionally, a ('Challenge-Data') TLV.</t>
          <t>
   The first message from the server is the one that starts Phase One,
   therefore the Server MUST set the headers' 'S' bit to '1' (Start) and
   the headers' 'Phase' value to '0x01' (Phase One).</t>
          <t>
   The Server uses one or more ('Version') TLVs in the EAP-Request/EAP-
   CREDS(Type=Init) message to provide the Peer with the list of EAP-
   CREDS versions supported.  If omitted, the implict version of EAP-
   CREDS used in the session is one ('0x1').  If the Server detects
   multiple occurrences of this TLV in the reply from the Peer, an error
   shall be issued and the EAP-CREDS session should be terminated.</t>
          <t>
   In case Token-Based registration is enabled on the Server, the Server
   MUST include, in its Init message, a ('Challenge-Data') field that
   can be used by the client to provide challenge data for proof-of-
   possession of secrets.</t>
        </section>
        <section anchor="sect-5.1.2" numbered="true" toc="default">
          <name>EAP Peer's Init Message</name>
          <t>
   The Peer MUST reply to the Server's ('EAP-CREDS-Init') message with
   its own ('EAP-CREDS-Init') one.  The Peer SHOULD include one
   ('Version') TLV in its first message to indicate the version of EAP-
   CREDS that the client wants to use for the session.  The Peer MUST
   also provide the list of supported provisioning protocols (via one or
   more the 'Protocol' TLV), the list and status of the installed
   credentials (via the 'Credentials-Info' TLV).  The Peer MAY include
   authorization data when registering new credentials (e.g., an
   authorization token or a device certifcate) via the ('Token-Data')
   and ('Challenge-Response') TLV.</t>
          <t>
   The Peer MUST include one ('Credentials-Info') TLV for each
   credential the Network is authorized to manage.  Typically, a Peer
   will include only one ('Credentials-Info') TLV in its ('EAP-CREDS-
   Init') message, but there might be cases where multiple types of
   credentials are available and selected depending on the location and
   other factors (e.g., X.509 certificate and username/password
   combination).</t>
          <t>
   In case the Peer does not have any credentials available yet, it does
   not add any ('Credentials-Info') TLV - leaving the Server with the
   only action possible: Registration.  In this case, the Peer SHOULD
   include authorization information via the ('Token-Data') TLV as
   described in <xref target="sect-5.1.2.1" format="default"/>.  Additionally, the Peer can add the
   ('Profile') TLV to indicate a preferred profile for the credentials.</t>
          <section anchor="sect-5.1.2.1" numbered="true" toc="default">
            <name>Bootstrapping Peer's Trustworthiness</name>
            <t>
   When the Peer does not have any valid credentials for the Network
   that it is authenticating to, it does not provide any ('Credentials-
   Info') TLV.  This indicates to the Server that new credentials MUST
   be registered before the Peer is allowed on the network.</t>
            <t>
   The Registration process might rely on information exchanged during
   the Provisioning Process in Phase Two. However, if an authorization
   mechanism is not available from the supported provisioning protocol
   and no credentials are available on the Peer, EAP-CREDS provides a
   simple machanism for the Peer to leverage an out-of-band
   token/passphrase/ott that may be already available on the Peer (e.g.,
   a device certificate or a 'spendable' credentials token like a
   kerberos ticket or a crypto-currency transaction) and that can be
   verified by the Server.</t>
            <t>
   In particular, when the Peer wants to register new credentials (and
   the Server requires the use of additional authorization data) it may
   need to provide (a) a Token, (b) a challenge value, and (c) a
   response to the challenge value.  To do so, the Peer MUST encode the
   token in a ('Token-Data') TLV, the challenge value in a ('Challenge-
   Data') TLV, and, finally, the response to the challenge in the
   ('Challenge-Response') TLV.</t>
            <t>
   The use of ('Challenge-Data') and ('Challenge-Response') TLVs is
   optional, however it is suggested that if a token is used for
   bootstrapping the trust, it should provide a way to verify a secret
   associated with it.</t>
            <t>
   It is also very important that the authorization token is disclosed
   only to authorized servers - the Peer MUST NOT disclose authorization
   tokens that are not meant for the network that is being accessed.
   This can be done, usually, by verifying the identity of the Server
   first (in the outer mechanism) and then verify that the target of the
   Token is the Server the Client is talking to.</t>
          </section>
        </section>
        <section anchor="sect-5.1.3" numbered="true" toc="default">
          <name>The EAP-CREDS-Provisioning Message</name>
          <t>
   The EAP-CREDS-Provisioning message type is used in Phase Two only of
   EAP-CREDS.  The message flow is depicted in <xref target="sect-3.4" format="default"/>.  This
   message type supports the following TLVs: Protocol, Profile,
   Credentials-Info, Provisioning-Headers, Provisioning-Data, Token-
   Data, and Error.</t>
          <t>
   After the exchange of Phase One messages, the Server MAY start phase
   two by issuing an ('EAP-CREDS-Provisioning') message for the Peer
   where it encodes all the required details for starting the
   provisioning process.  In particular, the server sends the selected
   ('Action'), ('Protocol'), and metadata to the client in a EAP-
   Request/EAP-CREDS(Type=Provisioning) message.  The header's 'S' bit
   MUST be set to '1' (Start) and the 'Phase' value set to '0x02' (Phase
   Two begins).</t>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      NOTE WELL: After the initial message, the only TLVs that are
      allowed in messages coming from the server are the usual
      ('Provisioning-Headers') ('Provisioning-Data'), and ('Error').</dd>
          </dl>
          <t>
   The client checks that all the selected parameters are supported for
   the selected credentials and, if no errors are detected, it sends its
   first ('EAP-CREDS-Provisioning') message to the Server with the
   ('Provisioning-Headers') and ('Provisioning-Data') TLVs only.</t>
          <t>
   From now on, the conversation between the Peer and the Server
   continues until an error is detected or the provisioning protocol
   completes successfully.</t>
          <t>
   If no other actions, the server MAY continue with phase three or
   issue a success message and terminate the EAP session.</t>
          <dl newline="false" spacing="normal" indent="3">
            <dt/>
            <dd>
      NOTE WELL: When the SPP protocol is used, the protocol messages
      that are encoded inside the ('Protocol-Data') TLV are composed of
      sets of TLVs as defined in this document.  The overall message
      size is provided by the size of the ('Protocol-Data') TLV that
      encapsulates the SPP-specific TLVs.  This design choice provides
      symmetry in implementing support for SPP when compared to other
      provisioning protocols.</dd>
          </dl>
        </section>
        <section anchor="sect-5.1.4" numbered="true" toc="default">
          <name>The EAP-CREDS-Validate Message</name>
          <t>
   The EAP-CREDS-Validate message type is used in Phase Three only of
   EAP-CREDS.  The message flow is depicted in <xref target="sect-3.5" format="default"/>.  This
   message type supports the following TLVs: Protocol, Credentials-Info,
   Provisioning-Headers, Provisioning-Data, Token-Data, and Error.</t>
          <t>
   After Phase One (and/or Phase Two) ends, the Server MAY start phase
   three by issuing an ('EAP-CREDS-Validate') message for the Peer where
   it encodes all the required details for starting the validation
   process.  In particular, the server sends the ('Credentials-Info'), a
   ('Challenge-Data'), in a EAP-Request/EAP-CREDS(Type=Validate)
   message.  The 'S' bit (Start) should set the '1' for its value and
   the 'Phase' field sets to '0x03' (Phase Three starts).</t>
          <t>
   The Peer generates the answer to the Challenge and sends back a EAP-
   Response/EAP-CREDS(Type=Validate) message with the ('Challenge-
   Response') and an optional ('Challenge') field (only for server-side
   validation of the symmetric credentials).  If the Peer requested
   server-side validation of the credentials, the Server MUST include
   (if a symmetric secret) the response to the Peer-issued ('Challenge-
   Data') TLV by computing the response and adding it to the
   ('Challenge-Response') TLV in its reply.</t>
          <t>
   Finally, in the last message, the Server (if Phase Three is to be
   ended) SHALL set the 'S' bit to '0' (end of phase) and the value of
   'Phase' field set to '0x03'.</t>
          <t>
   At this point, EAP-CREDS has terminated all possible operations and
   can be terminated.  The Server can now terminate the EAP session
   successfully.  In case the Peer was not authenticated during the
   tunnel establishment (i.e., no credentials were already available on
   the Peer), the Server should terminate the EAP session with a Failure
   (thus requiring the device to re-attach and authenticate to the
   network - phase two should have provided the Peer with the
   credentials to use for authenticating to the Network).</t>
        </section>
      </section>
    </section>
    <section anchor="sect-6" numbered="true" toc="default">
      <name>Error Handling in EAP-CREDS</name>
      <t>
   This section provides a description of the error handling by using
   the CREDS-Error-TLV in a CREDS message.</t>
    </section>
    <section anchor="sect-7" numbered="true" toc="default">
      <name>The Simple Provisioning Protocol (SPP)</name>
      <t>
   EAP-CREDS supports a Simple Provisioning Protocol (SPP) which
   comprises of a series of messages that enable the management not only
   of certificates, but also of other types of credentials like
   username/password pairs, asymmetric keys, and symmetric keys.</t>
      <t>
   The Simple Provisioning Protocol (SPP), described in this section,
   behaves as any other provisioning protocol: its messages are
   encapsulated in the ('Provisioning-Data') TLVs in the second phase of
   the protocol.  SPP does not make use of any ('Provisioning-Headers')
   TLVs because its messages are all self-contained (no transport-
   protocol specific options are needed).</t>
      <t>
   When no ('Credentials-Info') TLVs have been provided by the client,
   the Server knows that the device does not have valid credentials it
   wants to use to access the Network.  In this case, EAP-CREDS/SPP
   supports the use of Tokens to kick-off the registration process.  The
   type, format, or encoding of the Token is orthogonal to EAP-CREDS/SPP
   which treats the token as a black-box field (i.e., it SHOULD NOT try
   to interpret or parse its contents).</t>
      <dl newline="false" spacing="normal" indent="3">
        <dt/>
        <dd>
      NOTE WELL: During Phase One, the Peer MAY include the ('Token-
      Data') TLV in its EAP-CREDS-Init message to provide the needed
      authorization to register a new set of credentials.  The Server
      might not allow the registration of new credentials if the
      required authorization (i.e., the Token) was not provided during
      the initialization phase.</dd>
      </dl>
      <t>
   In the case where an authorization token is used, different usage
   patterns are supported.  For tokens that require an associated
   verifiable proof-of-possession, the Peer can include a ('Challenge-
   Response') TLVs.</t>
      <t>
   The ('Challenge-Data') TLV provided by the Server MUST be used to
   convey the challenge data (usually some random value) to compute the
   contents of the ('Challenge-Response') TLV.</t>
      <t>
   The ('Challenge-Response') TLV is used, instead, to encode the
   response to the challenge data.  The ('Challenge-Response') TLV is
   generated by the Peer and verified by the Server.  At minimum, the
   ('Challenge-Response') TLV SHOULD be calculated over the values of
   the ('Token-Data') and the ('Challenge-Data') TLVs to make sure that
   the authentication covers the token's data as well.</t>
      <dl newline="false" spacing="normal" indent="3">
        <dt/>
        <dd>
      NOTE WELL: The use of the ('Token-Data'), ('Challenge-Data'), and
      ('Challenge-Response') TLVs in the Peer's Init message is be used
      only to bootstrap trust between the Server and the Peer.  If the
      Server accepts the authorization information as valid, the Peer is
      enabled for registering new credentials.  This should happen only
      when the Peer does not have valid credentials or when the server
      wants to provision a different type of credentials (i.e.,
      Action=(Register)).  Other methods to provide authorization
      information might be provided by the selected provisioning
      protocol: in this case, the Server MAY enable registration of new
      credentials when no authorization data is provided in the 'Init'
      message from the client and delegate the validation of the
      authorization data during Phase Two.</dd>
      </dl>
      <section anchor="sect-7.1" numbered="true" toc="default">
        <name>SPP Message Format</name>
        <t>
   The SPP Messages are constructed with zero, one, or more TLVs and
   encoded in the ('Provisioning-Data') TLV in EAP-CREDS/Provisioning
   message types.  The size of the encpasulating ('Provisioning-Data')
   TLV provides the size of the whole message.</t>
      </section>
      <section anchor="sect-7.2" numbered="true" toc="default">
        <name>SPP Message Flow</name>
        <artwork name="" type="" align="left" alt=""><![CDATA[
 ,--------.                                 ,----------.
 |EAP Peer|                                 |EAP Server|
 `---+----'                                 `----+-----'
     | [1] EAP-Request/EAP-CREDS(Type=Provisioning) |
     |   { Protocol(=SPP), Action,               |
     |     [ CredsInfo ] [ Params ],             |
     |     [ ProvData(=CredsData) ] }            |
     | <------------------------------------------
     |                                           |
     | [2] EAP-Response/EAP-CREDS(Type=Provisioning)|
     |   { [ ProvData(=CredsData) ] }            |
     | ------------------------------------------>
     |                                           |
     | [3] EAP-Response/EAP-CREDS(Type=Provisioning)|
     |   { [ ProvData(=CredsData) ] }            |
     | <------------------------------------------
     |                                           |
     |                                           |
]]></artwork>
        <t>
   SPP was designed to provide an easy alternative to more complex
   provisioning protocols.  When no extra flexibility is needed, SPP
   provides an easy-to-implement alternative that can handle not only
   certificates, but also symmetric secrets and access tokens
   provisioning.  In this section we provide the generic flow of
   messages for SPP and specific examples for certificates, username/
   password, and token provisioning.</t>
        <t>
   EAP-CREDS defines several actions for a set of credentials and they
   are listed in <xref target="sect-8.9" format="default"/>.</t>
        <t>
   When a Peer wants to join a network it may or may not have have the
   needed credentials to do so.  In case the Peer does not have valid
   credentials yet, the Server MAY start Phase Two with the intention of
   registering a new set of credentials.  Alternatively, the Server MAY
   start Phase Two when the presented credentials information from the
   Peer triggers the Renew or the Remove action.</t>
        <dl newline="true" spacing="normal" indent="3">
          <dt>[1] The Server sends EAP-Request/EAP-CREDS(Type=Provisioning)</dt>
          <dd>
            <t>
	When registering new credentials, the first message from the
      Server, MUST not carry a ('Credentials-Info') TLV since there is
      no targeted credentials to apply the action on (i.e., for other
      actions - like 'renew' or 'remove' - the TLV would be required to
      identify the right set of credentials to renew or delete).
            </t>
            <t>
	In SPP, the Server sets the ('Protocol') TLV to SPP, the
      ('Action') TLV to 'Register', 'Renew', or 'Remove'.  When
      provisioning (or registering) new credentials for the Peer, the
      Server also sets the ('Provisioning-Params') TLV (or Params) to
      the type of credentials to be provisioned.  The Server also sets
      any relevant constraints, and, optionally, the ('Profile') TLV.
            </t>
            <t>
	NOTE WELL: If the Peer is authorized to register a new set of
         credentials, then the first message from the Server will have
         the ('Action') TLV set to 'register' and no ('Credentials-
         Info') TLV is present in the Server's message.  In case server-
         side generation is used, an additional ('Credentials-Info') TLV
         MAY be encoded inside the ('Provisioning-Data') TLV.
            </t>
            <t>
	If the type of credentials is symmetric and the parameters call
      for server-side generation of a symmetric key share, the Server
      MUST also include its own generated share in a ('Credentials-
      Data') TLV inside the ('Provisioning-Data') one (the data for the
      provisioning protocol are encapsulated in the 'Provisioning-Data'
      TLV for any protocol used during Phase Two - SPP is no exception
      to this rule).
            </t>
            <t>
	In case Server-side only is selected, the Server MUST send the new
      credentials in its message and include the ('Credentials-Info')
      TLV.  If no other credentials need to be managed, the Server MUST
      end Phase Two by setting the appropriate bits in the EAP-CREDS
      headers as well.
            </t>
          </dd>
          <dt>[2] The Peer sends EAP-Response/EAP-CREDS(Type=Provisioning)</dt>
          <dd>
	When Peer-generation is selected (either Peer-only or combined
      Peer and Server side) and Phase Two has not terminated yet, the
      Peer MUST reply to the Server's message with its own
      'Provisioning' response.  The response MUST carry either (a) its
      own generated share of the key in a ('Credentials-Data') TLV (if
      the credentials that are provisioned are symmetric and the
      configuration calls for a share of the key to be provided by the
      Peer) or (b) a PKCS#10 request in a ('Certificate-Request') TLV
      (also in this case, only if client-side generation was enabled by
      the Server) that is generated by using the parameters provided by
      the Server in the ('Provisioning-Params') TLV.
	</dd>
          <dt>[3] The Server sends EAP-Request/EAP-CREDS(Type=Provisioning)</dt>
          <dd>
            <t>
	The last message of SPP is from the Server and it is used to
      deliver the finalized value of the credentials and/or associated
      metadata.  In case the credentials being provisioned are
      Certificate-based, the Server MUST include the issued certificate
      in its reply.  The issued credentials shall be encoded in a
      ('Credentials-Data') TLV inside the ('Provisioning-Data') one.  In
      case that the selected format supported/selected by the Peer and
      the Server does not provide the possibility to encode the full
      chain (i.e., intermediate and Root CAs) in the response, the
      Server MUST add one ('Certificate-Data') TLV for each certificate
      in the chain (including the Root CA's certificate).
            </t>
            <t>
	The Server MUST include the ('Credentials-Info') TLV in its
      message.  This provide the Peer with some additional data (e.g.,
      the 'Profile' or the 'Identifier' associated with the credentials
      that were provisioned/managed).
            </t>
            <t>
	In the case where additional credentials need to be managed, the
      Server can continue Phase Two by issuing a new [1] message where
      the tuple Action/Credentials must be unique for the current EAP-
      CREDS session.
            </t>
            <t>
	The Server can now decide to start Phase Three (suggested if new
      credentials were provisioned or renewed) or to terminate the EAP
      session successfully.
            </t>
          </dd>
        </dl>
        <section anchor="sect-7.2.1" numbered="true" toc="default">
          <name>SPP Symmetric Secrets Management</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
 ,--------.                                      ,----------.
 |EAP Peer|                                      |EAP Server|
 `---+----'                                      `----+-----'
     | [1] EAP-Request/EAP-CREDS(Type=Provisioning)      |
     |   { Protocol(=SPP), Action, [ Creds-Info ],    |
     |     [ Prov-Params ], [ Profile ]               |
     |     [ Prov-Data(=[Creds-Info],[Creds-Data]) ] }|
     | <-----------------------------------------------
     |                                                |
     |   [2] EAP-Response/EAP-CREDS(Type=Provisioning)   |
     |     { [ Prov-Data(=[Creds-Data]) ] }           |
     | ----------------------------------------------->
     |                                                |
     |  [3] EAP-Response/EAP-CREDS(Type=Provisioning)    |
     |    { [ Prov-Data(=Creds-Info,[Creds-Data]) ] } |
     | <-----------------------------------------------
     |                                                |
     |                                                |
]]></artwork>
          <t>
   EAP-CREDS/SPP can provision symmetric secrets (e.g, username/
   password, API keys, or SIM-based keys), tokens (e.g., username/
   password OAuth or Kerberos tokens), or asymmetric credentials (e.g.,
   X.509 certificates or Key Pairs).  This section focuses on
   provisioning symmetric secrets only.  The message flow is provided in
   <xref target="sect-7.2.1" format="default"/>
          </t>
          <t>
   EAP-CREDS/SPP provides the possibility for shared secret to be
   generated in different ways:</t>
          <ol spacing="normal" type="1"><li>Server-Side Generated</li>
            <li>Client-Side Generated</li>
            <li>Both Client-Side and Server-Side Generated</li>
          </ol>
          <t>
   In particular, when initiating the second phase of the protocol, the
   ('Provisioning-Params') TLV is used to specify how to generate the
   secret (see <xref target="sect-4.3.13" format="default"/>).</t>
          <section anchor="sect-7.2.1.1" numbered="true" toc="default">
            <name>Server Side Only Generation</name>
            <t>
   [ TO BE EDITED ]</t>
            <t>
   Figure 1: SPP Message Flow for Server-Side only secrets provisioning</t>
            <t>
   The message flow for deploying a server-side only credential (i.e.,
   during registration or renewal) consists of only one message from the
   server.  The flow is depicted in Figure 1.</t>
            <t>
   In this case, the Server sends the first Provisioning message (which
   is also the last one), which MUST carry, the following data:</t>
            <ul spacing="normal">
              <li>The ('Credentials-Info') TLV that specifies the info for the
      provisioned secret, and</li>
              <li>The ('Protocol') TLV that specifies the provisioning protocol to
      be used, and</li>
              <li>The ('Action') TLV that provides the action to be performed
      ('Registration') or ('Renew'), and</li>
              <li>The ('Provisioning-Params') TLV that provides the generation
      parameters to the Peer, and</li>
            </ul>
            <t>
   The Server also includes, encoded in the ('Provisioning-Data') TLV,
   the following data:</t>
            <dl newline="false" spacing="normal" indent="3">
              <dt/>
              <dd>
      The ('Credentials-Info') TLV that provides the metadata associated
      with teh generated secret</dd>
            </dl>
            <dl newline="false" spacing="normal" indent="3">
              <dt/>
              <dd>
      The ('Credentials-Data') TLV that provides the secret that is
      provisioned to the Peer</dd>
            </dl>
            <t>
   Server-side secrets' generation can be used to generate username/
   password combinations, API Keys, SIM-based credentials, or tokens.</t>
          </section>
          <section anchor="sect-7.2.1.2" numbered="true" toc="default">
            <name>Client Side Only Generation</name>
            <t>
   [ TO BE EDITED ]</t>
            <t>
   Figure 2: SPP Message Flow for Client-Side only secrets provisioning</t>
            <t>
   The message flow for deploying a client-side only credential (i.e.,
   during registration or renewal) consists of the full three messages
   exchange.  The flow is depicted in Figure 2.</t>
            <t>
   In this case, the Server MUST include, in its first Provisioning
   message and encoded in the ('Provisioning-Data') TLV, the following
   data:</t>
            <ul spacing="normal">
              <li>The ('Credentials-Info') TLV that specifies the target
      credentials, and</li>
              <li>The ('Protocol') TLV that specifies the provisioning protocol to
      be used, and</li>
              <li>The ('Action') TLV that provides the action to be performed
      ('Registration') or ('Renew'), and</li>
              <li>The ('Provisioning-Params') TLV that provides the generation
      parameters to the Peer, and</li>
            </ul>
            <t>
   Notice that the Server does not include any ('Credentials-Data') TLV
   in its first message because the Server is not involved in the secret
   generation (client-side only).</t>
            <t>
   The Peer MUST reply with its own Provisioning message where the Peer
   MUST encode the following data in the ('Provisioning-Data') TLV:</t>
            <dl newline="false" spacing="normal" indent="3">
              <dt/>
              <dd>
      The ('Credentials-Data') TLV that provides the secret that is
      being registered</dd>
            </dl>
            <t>
   The credentials data MUST conform to the specifications the Server
   provided in the ('Provisioning-Params') TLV.</t>
            <t>
   The final message is from the Server and it MUST contain (if no
   errors were detected), the following TLVs encoded, as usual, in the
   ('Provisioning-Data') TLV:</t>
            <dl newline="false" spacing="normal" indent="3">
              <dt/>
              <dd>
      The ('Credentials-Info') TLV that specifies the metadata
      associated with the generated secret, and</dd>
            </dl>
            <dl newline="false" spacing="normal" indent="3">
              <dt/>
              <dd>
      The ('Credentials-Data') TLV that provides the secret that is
      provisioned to the Peer</dd>
            </dl>
            <t>
   Client-side secrets' generation should be used with caution and an
   evaluation of the quality of the generated credentials MUST be
   performed to make sure that the security of the generated secret is
   adequate for accessing the network.  Since evaluating the quality of
   a secret is quite a difficult tasks, the use of this generation mode
   MUST be evaluated carefully and selected accordingly to acceptable
   risk profiles.</t>
          </section>
          <section anchor="sect-7.2.1.3" numbered="true" toc="default">
            <name>Client and Server Side Generation</name>
            <t>
   When registering or renewing credentials and the secret generation is
   split between the Server (1st share) and the Peer (2nd share), the
   message flow is the same as <xref target="sect-7.2.1.2" format="default"/> with the following
   exceptions:</t>
            <ul spacing="normal">
              <li>The Server MUST send its own share of the secret by including a
      ('Credentials-Data') TLV in its first message.</li>
            </ul>
            <t>
   All other parameters remain the same.</t>
            <t>
   Co-generation of the secret is the most secure option because both
   parties can provide the required randomness in their own share of the
   secret.</t>
          </section>
        </section>
        <section anchor="sect-7.2.2" numbered="true" toc="default">
          <name>SPP Key Pair Provisioning</name>
          <t>
   EAP-CREDS/SSP defines the following flow of messages for requesting
   the provisioning of key pairs (public and private keys).</t>
          <section anchor="sect-7.2.2.1" numbered="true" toc="default">
            <name>Server Side Only Generation</name>
            <t>
   [ This case covers the server-side generation of KeyPair and Certificate ]</t>
          </section>
          <section anchor="sect-7.2.2.2" numbered="true" toc="default">
            <name>Client Side Only Generation</name>
            <t>
   [ This case covers the registration of a self-signed or already available (e.g., device) certificate ]</t>
          </section>
          <section anchor="sect-7.2.2.3" numbered="true" toc="default">
            <name>Client and Server Side Generation</name>
            <t>
   This use-case is not supported.  In other words, for the provisioning
   of Key Pairs, the ('Provisioning-Params') can not have both the peer-
   generation and server-generation bits set.</t>
          </section>
        </section>
        <section anchor="sect-7.2.3" numbered="true" toc="default">
          <name>SPP Certificate Provisioning</name>
          <t>
   EAP-CREDS/SSP defines the following flow of messages for requesting
   the provisioning of credentials.</t>
          <section anchor="sect-7.2.3.1" numbered="true" toc="default">
            <name>Server Side Only Generation</name>
            <t>
   [ This case covers the server-side generation of KeyPair and Certificate ]</t>
          </section>
          <section anchor="sect-7.2.3.2" numbered="true" toc="default">
            <name>Client Side Only Generation</name>
            <t>
   [ This case covers the registration of a self-signed or already available (e.g., device) certificate ]</t>
          </section>
          <section anchor="sect-7.2.3.3" numbered="true" toc="default">
            <name>Client and Server Side Generation</name>
            <t>
   [ This case covers the generation of the KeyPair on the Peer and the generation of the certificate on the Server ]</t>
          </section>
        </section>
        <section anchor="sect-7.2.4" numbered="true" toc="default">
          <name>SPP Token Provisioning</name>
          <t>
   EAP-CREDS/SSP defines the following flow of messages for requesting
   the provisioning of token-based credentials.</t>
          <section anchor="sect-7.2.4.1" numbered="true" toc="default">
            <name>Server Side Only Generation</name>
            <t>
   [ This case covers the server-side generation of the Token and possibly associated key ]</t>
          </section>
          <section anchor="sect-7.2.4.2" numbered="true" toc="default">
            <name>Client Side Only Generation</name>
            <t>
   [ This case covers the registration of a self-signed or already available (e.g., device) certificate ]</t>
          </section>
          <section anchor="sect-7.2.4.3" numbered="true" toc="default">
            <name>Client and Server Side Generation</name>
            <t>
   [ This case covers the generation of the KeyPair on the Peer and the generation of the Token that cointains the reference to the key on the Server ]</t>
          </section>
        </section>
      </section>
    </section>
    <section anchor="sect-8" numbered="true" toc="default">
      <name>IANA Considerations</name>
      <t>
   This document uses a new EAP type, EAP-CREDS, whose value (TBD) MUST
   be allocated by IANA from the EAP TYPEs subregistry of the RADIUS
   registry.  This section provides guidance to the Internet Assigned
   Numbers Authority (IANA) regarding registration of values related to
   the EAP-CREDS protocol, in accordance with <xref target="RFC8126" format="default"/>.</t>
      <t>
   The EAP Method Type number for EAP-CREDS needs to be assigned.</t>
      <t>
   This document also requires IANA to create new registries as defined
   in the following subsections.</t>
      <section anchor="sect-8.1" numbered="true" toc="default">
        <name>Provisioning Protocols</name>
        <table anchor="tab-eap-creds-inner-protocol-identifiers" align="center">
          <name>EAP-CREDS Inner Protocol Identifiers</name>
          <thead>
            <tr>
              <th align="left"> Message Type</th>
              <th align="left"> Purpose</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">0</td>
              <td align="left">Unspecified</td>
            </tr>
            <tr>
              <td align="left">1</td>
              <td align="left">Simple Provisioning Protocol (SPP)</td>
            </tr>
            <tr>
              <td align="left">2</td>
              <td align="left">Basic Certificate Management Protocol (CMP-S)</td>
            </tr>
            <tr>
              <td align="left">3</td>
              <td align="left">Full Certificate Management Protocol (CMP-F)</td>
            </tr>
            <tr>
              <td align="left">4</td>
              <td align="left">Enrollment over Secure Transport (EST)</td>
            </tr>
            <tr>
              <td align="left">5</td>
              <td align="left">Certificate Management over CMS (CMC)</td>
            </tr>
            <tr>
              <td align="left">6</td>
              <td align="left">Automatic Certificate Management Environment</td>
            </tr>
            <tr>
              <td align="left"/>
              <td align="left">(ACME)</td>
            </tr>
            <tr>
              <td align="left">...</td>
              <td align="left">...</td>
            </tr>
            <tr>
              <td align="left">49141 ... 65534</td>
              <td align="left">Vendor Specific</td>
            </tr>
          </tbody>
        </table>
        <t>
   Assignment of new values for new cryptosuites MUST be done through
   IANA with "Specification Required" and "IESG Approval" as defined in
   <xref target="RFC8126" format="default"/>.</t>
      </section>
      <section anchor="sect-8.2" numbered="true" toc="default">
        <name>Token Types</name>
        <table anchor="tab-token-types" align="center">
          <name>Token Types</name>
          <thead>
            <tr>
              <th align="left"> Token Type</th>
              <th align="left"> Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">0</td>
              <td align="left">Unspecified</td>
            </tr>
            <tr>
              <td align="left">1</td>
              <td align="left">JWT</td>
            </tr>
            <tr>
              <td align="left">2</td>
              <td align="left">Kerberos</td>
            </tr>
            <tr>
              <td align="left">3</td>
              <td align="left">OAuth</td>
            </tr>
            <tr>
              <td align="left">4</td>
              <td align="left">Certificate</td>
            </tr>
            <tr>
              <td align="left">200..254</td>
              <td align="left">Vendor Specific</td>
            </tr>
          </tbody>
        </table>
        <t>
   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in <xref target="RFC8126" format="default"/>.</t>
      </section>
      <section anchor="sect-8.3" numbered="true" toc="default">
        <name>Credentials Types</name>
        <table anchor="tab-credentials-types" align="center">
          <name>Credentials Types</name>
          <thead>
            <tr>
              <th align="left"> Credentials Type</th>
              <th align="left"> Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">0</td>
              <td align="left">X.509 Certificate</td>
            </tr>
            <tr>
              <td align="left">1</td>
              <td align="left">Public Key</td>
            </tr>
            <tr>
              <td align="left">2</td>
              <td align="left">Symmetric Key</td>
            </tr>
            <tr>
              <td align="left">3</td>
              <td align="left">Username and Password</td>
            </tr>
            <tr>
              <td align="left">4</td>
              <td align="left">AKA Subscriber Key</td>
            </tr>
            <tr>
              <td align="left">5</td>
              <td align="left">Bearer Token</td>
            </tr>
            <tr>
              <td align="left">6</td>
              <td align="left">One-Time Token</td>
            </tr>
            <tr>
              <td align="left">7</td>
              <td align="left">API Key</td>
            </tr>
          </tbody>
        </table>
        <t>
   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in <xref target="RFC8126" format="default"/>.</t>
      </section>
      <section anchor="sect-8.4" numbered="true" toc="default">
        <name>Credentials Algorithms</name>
        <table anchor="tab-credentials-algorithms" align="center">
          <name>Credentials Algorithms</name>
          <thead>
            <tr>
              <th align="left"> ID</th>
              <th align="left"> Algorithm</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">0</td>
              <td align="left">None</td>
            </tr>
            <tr>
              <td align="left">1</td>
              <td align="left">RSA</td>
            </tr>
            <tr>
              <td align="left">2</td>
              <td align="left">ECDSA</td>
            </tr>
            <tr>
              <td align="left">3</td>
              <td align="left">XMMS</td>
            </tr>
            <tr>
              <td align="left">4</td>
              <td align="left">AKA Subscriber Key</td>
            </tr>
            <tr>
              <td align="left">5</td>
              <td align="left">OAuth</td>
            </tr>
            <tr>
              <td align="left">6</td>
              <td align="left">Kerberos4</td>
            </tr>
            <tr>
              <td align="left">7</td>
              <td align="left">Kerberos5</td>
            </tr>
            <tr>
              <td align="left">200-254</td>
              <td align="left">Reserved</td>
            </tr>
          </tbody>
        </table>
        <t>
   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in <xref target="RFC8126" format="default"/>.</t>
      </section>
      <section anchor="sect-8.5" numbered="true" toc="default">
        <name>Credentials Datatypes</name>
        <table anchor="tab-credentials-datatypes" align="center">
          <name>Credentials Datatypes</name>
          <thead>
            <tr>
              <th align="left"> ID</th>
              <th align="left"> Data Type</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">0</td>
              <td align="left">None (Binary)</td>
            </tr>
            <tr>
              <td align="left">1</td>
              <td align="left">PKCS#8</td>
            </tr>
            <tr>
              <td align="left">2</td>
              <td align="left">PKCS#10</td>
            </tr>
            <tr>
              <td align="left">3</td>
              <td align="left">PKCS#12</td>
            </tr>
            <tr>
              <td align="left">4</td>
              <td align="left">PublicKeyInfo</td>
            </tr>
            <tr>
              <td align="left">200-254</td>
              <td align="left">Reserved</td>
            </tr>
          </tbody>
        </table>
        <t>
   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in <xref target="RFC8126" format="default"/>.</t>
      </section>
      <section anchor="sect-8.6" numbered="true" toc="default">
        <name>Challenge Types</name>
        <table anchor="tab-challenge-type" align="center">
          <name>Challenge Type</name>
          <thead>
            <tr>
              <th align="left"> ID</th>
              <th align="left"> Data Type</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">0</td>
              <td align="left">Not Specified</td>
            </tr>
            <tr>
              <td align="left">1</td>
              <td align="left">EAP-CREDS-ASYMMETRIC</td>
            </tr>
            <tr>
              <td align="left">2</td>
              <td align="left">EAP-CREDS-SYMMETRIC</td>
            </tr>
          </tbody>
        </table>
        <t>
   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in <xref target="RFC8126" format="default"/>.</t>
      </section>
      <section anchor="sect-8.7" numbered="true" toc="default">
        <name>Network Usage Datatypes</name>
        <table anchor="tab-network-usage-datatypes" align="center">
          <name>Network Usage Datatypes</name>
          <thead>
            <tr>
              <th align="left"> ID</th>
              <th align="left"> Data Type</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">0</td>
              <td align="left">Vendor-Specific</td>
            </tr>
            <tr>
              <td align="left">1</td>
              <td align="left">Manufacturer Usage Description [RFC8520]</td>
            </tr>
            <tr>
              <td align="left">2</td>
              <td align="left">Network Access Granting System</td>
            </tr>
            <tr>
              <td align="left">3</td>
              <td align="left">Firmware Manifest</td>
            </tr>
            <tr>
              <td align="left">4..127</td>
              <td align="left">Reserved for Future Use</td>
            </tr>
          </tbody>
        </table>
        <t>
   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in <xref target="RFC8126" format="default"/>.</t>
      </section>
      <section anchor="sect-8.8" numbered="true" toc="default">
        <name>Credentials Encoding</name>
        <table anchor="tab-credentials-encoding" align="center">
          <name>Credentials Encoding</name>
          <thead>
            <tr>
              <th align="left"> ID</th>
              <th align="left"> Encoding</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">0</td>
              <td align="left">None (Raw)</td>
            </tr>
            <tr>
              <td align="left">1</td>
              <td align="left">DER</td>
            </tr>
            <tr>
              <td align="left">2</td>
              <td align="left">PEM</td>
            </tr>
            <tr>
              <td align="left">3</td>
              <td align="left">Base64</td>
            </tr>
            <tr>
              <td align="left">4</td>
              <td align="left">JSON</td>
            </tr>
            <tr>
              <td align="left">5</td>
              <td align="left">XML</td>
            </tr>
            <tr>
              <td align="left">6</td>
              <td align="left">ASCII</td>
            </tr>
            <tr>
              <td align="left">7</td>
              <td align="left">UTF-8</td>
            </tr>
            <tr>
              <td align="left">200-254</td>
              <td align="left">Reserved</td>
            </tr>
          </tbody>
        </table>
        <t>
   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in <xref target="RFC8126" format="default"/>.</t>
      </section>
      <section anchor="sect-8.9" numbered="true" toc="default">
        <name>Action Types</name>
        <table anchor="tab-action-types" align="center">
          <name>Action Types</name>
          <thead>
            <tr>
              <th align="left"> ID</th>
              <th align="left"> Data Type</th>
              <th align="left"> Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">0</td>
              <td align="left">Registration</td>
              <td align="left">Registers New Credentials</td>
            </tr>
            <tr>
              <td align="left">1</td>
              <td align="left">Renewal</td>
              <td align="left">Renew an Existing Credential</td>
            </tr>
            <tr>
              <td align="left">2</td>
              <td align="left">Remove</td>
              <td align="left">Removes an Existing Credential</td>
            </tr>
            <tr>
              <td align="left">200-254</td>
              <td align="left">n/a</td>
              <td align="left">Reserved</td>
            </tr>
          </tbody>
        </table>
        <t>
   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in <xref target="RFC8126" format="default"/>.</t>
      </section>
      <section anchor="sect-8.10" numbered="true" toc="default">
        <name>Usage Metadata Types</name>
        <table anchor="tab-usage-metadata-types" align="center">
          <name>Usage Metadata Types</name>
          <thead>
            <tr>
              <th align="left"> Type</th>
              <th align="left"> Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">0</td>
              <td align="left">Binary (Unspecified)</td>
            </tr>
            <tr>
              <td align="left">1</td>
              <td align="left">MUD File</td>
            </tr>
            <tr>
              <td align="left">2</td>
              <td align="left">TEEP Manifest</td>
            </tr>
          </tbody>
        </table>
        <t>
   Assignment of new values for new Message Types MUST be done through
   IANA with "Expert Review" as defined in <xref target="RFC8126" format="default"/>.</t>
      </section>
    </section>
    <section anchor="sect-9" numbered="true" toc="default">
      <name>Security Considerations</name>
      <t>
   Several security considerations need to be explicitly considered for
   the system administrators and application developers to understand
   the weaknesses of the overall architecture.</t>
      <t>
   The most important security consideration when deploying EAP-CREDS is
   related to the security of the outer channel.  In particular, EAP-
   CREDS assumes that the communication channel has been properly
   authenticated and that the information exchanged between the Peer and
   the Server are protected (i.e., confidentiality and integrity).</t>
      <t>
   For example, if certificate-based authentication is used, the server
   presents a certificate to the peer as part of the trust establishment
   (or negotiation).  The peer SHOULD verify the validity of the EAP
   server certificate and SHOULD also examine the EAP server name
   presented in the certificate in order to determine whether the EAP
   server can be trusted.  When performing server certificate
   validation, implementations MUST provide support for the rules in
   <xref target="RFC5280" format="default"/> for validating certificates against a known trust anchor.</t>
    </section>
    <section anchor="sect-10" numbered="true" toc="default">
      <name>Acknowledgments</name>
      <t>
   The authors would like to thank everybody who provided insightful
   comments and helped in the definition of the deployment
   considerations.</t>
    </section>
  </middle>
  <back>
    <references>
      <name>Normative References</name>
      <reference anchor="RFC2119" target="https://www.rfc-editor.org/info/rfc2119" xml:base="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
        <front>
          <title>Key words for use in RFCs to Indicate Requirement Levels</title>
          <author initials="S." surname="Bradner" fullname="S. Bradner">
            <organization/>
          </author>
          <date year="1997" month="March"/>
          <abstract>
            <t>In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
          </abstract>
        </front>
        <seriesInfo name="BCP" value="14"/>
        <seriesInfo name="RFC" value="2119"/>
        <seriesInfo name="DOI" value="10.17487/RFC2119"/>
      </reference>
      <reference anchor="RFC3748" target="https://www.rfc-editor.org/info/rfc3748" xml:base="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.3748.xml">
        <front>
          <title>Extensible Authentication Protocol (EAP)</title>
          <author initials="B." surname="Aboba" fullname="B. Aboba">
            <organization/>
          </author>
          <author initials="L." surname="Blunk" fullname="L. Blunk">
            <organization/>
          </author>
          <author initials="J." surname="Vollbrecht" fullname="J. Vollbrecht">
            <organization/>
          </author>
          <author initials="J." surname="Carlson" fullname="J. Carlson">
            <organization/>
          </author>
          <author initials="H." surname="Levkowetz" fullname="H. Levkowetz" role="editor">
            <organization/>
          </author>
          <date year="2004" month="June"/>
          <abstract>
            <t>This document defines the Extensible Authentication Protocol (EAP), an authentication framework which supports multiple authentication methods.  EAP typically runs directly over data link layers such as Point-to-Point Protocol (PPP) or IEEE 802, without requiring IP.  EAP provides its own support for duplicate elimination and retransmission, but is reliant on lower layer ordering guarantees.  Fragmentation is not supported within EAP itself; however, individual EAP methods may support this.  This document obsoletes RFC 2284.  A summary of the changes between this document and RFC 2284 is available in Appendix A.  [STANDARDS-TRACK]</t>
          </abstract>
        </front>
        <seriesInfo name="RFC" value="3748"/>
        <seriesInfo name="DOI" value="10.17487/RFC3748"/>
      </reference>
      <reference anchor="RFC4210" target="https://www.rfc-editor.org/info/rfc4210" xml:base="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.4210.xml">
        <front>
          <title>Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP)</title>
          <author initials="C." surname="Adams" fullname="C. Adams">
            <organization/>
          </author>
          <author initials="S." surname="Farrell" fullname="S. Farrell">
            <organization/>
          </author>
          <author initials="T." surname="Kause" fullname="T. Kause">
            <organization/>
          </author>
          <author initials="T." surname="Mononen" fullname="T. Mononen">
            <organization/>
          </author>
          <date year="2005" month="September"/>
          <abstract>
            <t>This document describes the Internet X.509 Public Key Infrastructure (PKI) Certificate Management Protocol (CMP).  Protocol messages are defined for X.509v3 certificate creation and management.  CMP provides on-line interactions between PKI components, including an exchange between a Certification Authority (CA) and a client system.  [STANDARDS-TRACK]</t>
          </abstract>
        </front>
        <seriesInfo name="RFC" value="4210"/>
        <seriesInfo name="DOI" value="10.17487/RFC4210"/>
      </reference>
      <reference anchor="RFC5272" target="https://www.rfc-editor.org/info/rfc5272" xml:base="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5272.xml">
        <front>
          <title>Certificate Management over CMS (CMC)</title>
          <author initials="J." surname="Schaad" fullname="J. Schaad">
            <organization/>
          </author>
          <author initials="M." surname="Myers" fullname="M. Myers">
            <organization/>
          </author>
          <date year="2008" month="June"/>
          <abstract>
            <t>This document defines the base syntax for CMC, a Certificate Management protocol using the Cryptographic Message Syntax (CMS). This protocol addresses two immediate needs within the Internet Public Key Infrastructure (PKI) community:</t>
            <t>1.  The need for an interface to public key certification products and services based on CMS and PKCS #10 (Public Key Cryptography Standard), and</t>
            <t>2.  The need for a PKI enrollment protocol for encryption only keys due to algorithm or hardware design.</t>
            <t>CMC also requires the use of the transport document and the requirements usage document along with this document for a full definition.  [STANDARDS-TRACK]</t>
          </abstract>
        </front>
        <seriesInfo name="RFC" value="5272"/>
        <seriesInfo name="DOI" value="10.17487/RFC5272"/>
      </reference>
      <reference anchor="RFC5280" target="https://www.rfc-editor.org/info/rfc5280" xml:base="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5280.xml">
        <front>
          <title>Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</title>
          <author initials="D." surname="Cooper" fullname="D. Cooper">
            <organization/>
          </author>
          <author initials="S." surname="Santesson" fullname="S. Santesson">
            <organization/>
          </author>
          <author initials="S." surname="Farrell" fullname="S. Farrell">
            <organization/>
          </author>
          <author initials="S." surname="Boeyen" fullname="S. Boeyen">
            <organization/>
          </author>
          <author initials="R." surname="Housley" fullname="R. Housley">
            <organization/>
          </author>
          <author initials="W." surname="Polk" fullname="W. Polk">
            <organization/>
          </author>
          <date year="2008" month="May"/>
          <abstract>
            <t>This memo profiles the X.509 v3 certificate and X.509 v2 certificate revocation list (CRL) for use in the Internet.  An overview of this approach and model is provided as an introduction.  The X.509 v3 certificate format is described in detail, with additional information regarding the format and semantics of Internet name forms.  Standard certificate extensions are described and two Internet-specific extensions are defined.  A set of required certificate extensions is specified.  The X.509 v2 CRL format is described in detail along with standard and Internet-specific extensions.  An algorithm for X.509 certification path validation is described.  An ASN.1 module and examples are provided in the appendices.  [STANDARDS-TRACK]</t>
          </abstract>
        </front>
        <seriesInfo name="RFC" value="5280"/>
        <seriesInfo name="DOI" value="10.17487/RFC5280"/>
      </reference>
      <reference anchor="RFC6402" target="https://www.rfc-editor.org/info/rfc6402" xml:base="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6402.xml">
        <front>
          <title>Certificate Management over CMS (CMC) Updates</title>
          <author initials="J." surname="Schaad" fullname="J. Schaad">
            <organization/>
          </author>
          <date year="2011" month="November"/>
          <abstract>
            <t>This document contains a set of updates to the base syntax for CMC, a Certificate Management protocol using the Cryptographic Message Syntax (CMS).  This document updates RFC 5272, RFC 5273, and RFC 5274.</t>
            <t>The new items in this document are: new controls for future work in doing server side key generation, definition of a Subject Information Access value to identify CMC servers, and the registration of a port number for TCP/IP for the CMC service to run on.  [STANDARDS-TRACK]</t>
          </abstract>
        </front>
        <seriesInfo name="RFC" value="6402"/>
        <seriesInfo name="DOI" value="10.17487/RFC6402"/>
      </reference>
      <reference anchor="RFC7030" target="https://www.rfc-editor.org/info/rfc7030" xml:base="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7030.xml">
        <front>
          <title>Enrollment over Secure Transport</title>
          <author initials="M." surname="Pritikin" fullname="M. Pritikin" role="editor">
            <organization/>
          </author>
          <author initials="P." surname="Yee" fullname="P. Yee" role="editor">
            <organization/>
          </author>
          <author initials="D." surname="Harkins" fullname="D. Harkins" role="editor">
            <organization/>
          </author>
          <date year="2013" month="October"/>
          <abstract>
            <t>This document profiles certificate enrollment for clients using Certificate Management over CMS (CMC) messages over a secure transport.  This profile, called Enrollment over Secure Transport (EST), describes a simple, yet functional, certificate management protocol targeting Public Key Infrastructure (PKI) clients that need to acquire client certificates and associated Certification Authority (CA) certificates.  It also supports client-generated public/private key pairs as well as key pairs generated by the CA.</t>
          </abstract>
        </front>
        <seriesInfo name="RFC" value="7030"/>
        <seriesInfo name="DOI" value="10.17487/RFC7030"/>
      </reference>
      <reference anchor="RFC8126" target="https://www.rfc-editor.org/info/rfc8126" xml:base="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8126.xml">
        <front>
          <title>Guidelines for Writing an IANA Considerations Section in RFCs</title>
          <author initials="M." surname="Cotton" fullname="M. Cotton">
            <organization/>
          </author>
          <author initials="B." surname="Leiba" fullname="B. Leiba">
            <organization/>
          </author>
          <author initials="T." surname="Narten" fullname="T. Narten">
            <organization/>
          </author>
          <date year="2017" month="June"/>
          <abstract>
            <t>Many protocols make use of points of extensibility that use constants to identify various protocol parameters.  To ensure that the values in these fields do not have conflicting uses and to promote interoperability, their allocations are often coordinated by a central record keeper.  For IETF protocols, that role is filled by the Internet Assigned Numbers Authority (IANA).</t>
            <t>To make assignments in a given registry prudently, guidance describing the conditions under which new values should be assigned, as well as when and how modifications to existing values can be made, is needed.  This document defines a framework for the documentation of these guidelines by specification authors, in order to assure that the provided guidance for the IANA Considerations is clear and addresses the various issues that are likely in the operation of a registry.</t>
            <t>This is the third edition of this document; it obsoletes RFC 5226.</t>
          </abstract>
        </front>
        <seriesInfo name="BCP" value="26"/>
        <seriesInfo name="RFC" value="8126"/>
        <seriesInfo name="DOI" value="10.17487/RFC8126"/>
      </reference>
      <reference anchor="RFC8520" target="https://www.rfc-editor.org/info/rfc8520" xml:base="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8520.xml">
        <front>
          <title>Manufacturer Usage Description Specification</title>
          <author initials="E." surname="Lear" fullname="E. Lear">
            <organization/>
          </author>
          <author initials="R." surname="Droms" fullname="R. Droms">
            <organization/>
          </author>
          <author initials="D." surname="Romascanu" fullname="D. Romascanu">
            <organization/>
          </author>
          <date year="2019" month="March"/>
          <abstract>
            <t>This memo specifies a component-based architecture for Manufacturer Usage Descriptions (MUDs).  The goal of MUD is to provide a means for end devices to signal to the network what sort of access and network functionality they require to properly function.  The initial focus is on access control.  Later work can delve into other aspects.</t>
            <t>This memo specifies two YANG modules, IPv4 and IPv6 DHCP options, a Link Layer Discovery Protocol (LLDP) TLV, a URL, an X.509 certificate extension, and a means to sign and verify the descriptions.</t>
          </abstract>
        </front>
        <seriesInfo name="RFC" value="8520"/>
        <seriesInfo name="DOI" value="10.17487/RFC8520"/>
      </reference>
    </references>
  </back>
</rfc>
